parentOf(Manipulate_System_Resources, Infrastructure_Manipulation).
parentOf(Manipulate_System_Resources, File_Manipulation).
parentOf(Manipulate_System_Resources, Configuration_Environment_Manipulation).
parentOf(Manipulate_System_Resources, Software_Integrity_Attack).
parentOf(Manipulate_System_Resources, Modification_During_Manufacture).
parentOf(Manipulate_System_Resources, Infrastructure_Manipulation).
parentOf(Manipulate_System_Resources, Manipulation_During_Distribution).
parentOf(Manipulate_System_Resources, Hardware_Integrity_Attack).
parentOf(Manipulate_System_Resources, Malicious_Logic_Insertion).
parentOf(Manipulate_System_Resources, Contaminate_Resource).
parentOf(Manipulate_System_Resources, Obstruction).

parentOf(Infrastructure_Manipulation, Cache_poisoning).
parentOf(Infrastructure_Manipulation, Force_the_System_to_Reset_Values).
parentOf(Infrastructure_Manipulation, Audit_Log_Manipulation).
parentOf(Infrastructure_Manipulation, Contradictory_Destinations_In_Traffic_Routing).
parentOf(Infrastructure_Manipulation, Block_Logging_To_Central_Repository).


parentOf(Cache_poisoning, DNS_Cache_Poisoning).


parentOf(Audit_Log_Manipulation, Web_Logs_Tampering).
parentOf(Audit_Log_Manipulation, Log_Injection-Tampering-Forging).


parentOf(File_Manipulation, User-Controlled_Filename).
parentOf(File_Manipulation, Artificially_Inflate_File_Sizes).
parentOf(File_Manipulation, Alternative_Execution_Due_to_Deceptive_Filenames).
parentOf(File_Manipulation, Hiding_Malicious_Data_or_Code_within_Files).
parentOf(File_Manipulation, Windows_Admin_Shares_with_Stolen_Credentials).
parentOf(File_Manipulation, Use_of_Captured_Hashes).


parentOf(Artificially_Inflate_File_Sizes, Avoid_Security_Tool_Identification_by_ Adding_Data).


parentOf(Alternative_Execution_Due_to_Deceptive_Filenames, Cause_Web_Server_Misclassification).
parentOf(Alternative_Execution_Due_to_Deceptive_Filenames, Adding_a_Space_to_a_File_Extension).



parentOf(Hiding_Malicious_Data_or_Code_within_Files, Leverage_Executable_Code_in_Non-Executable_Files).
parentOf(Hiding_Malicious_Data_or_Code_within_Files, Windows::DATA_Alternate_Data_Stream).


parentOf(Configuration/Environment_Manipulation, Manipulating_Writeable_Configuration_Files).
parentOf(Configuration/Environment_Manipulation, Manipulate_Registry_Information).
parentOf(Configuration/Environment_Manipulation, Schema_Poisoning).
parentOf(Configuration/Environment_Manipulation, Data_Injected_During_Configuration).
parentOf(Configuration/Environment_Manipulation, Disable_Security_Software).


parentOf(Manipulate_Registry_Information,Poison_Web_Service_Registry).
parentOf(Manipulate_Registry_Information,Modification_of_Registry_Run_Keys).
parentOf(Manipulate_Registry_Information,Modification_of_Windows_Service_Configuration).


parentOf(Schema_Poisoning,XML_Schema_Poisoning).



parentOf(Software_Integrity_Attack, Malicious_Software_Download).
parentOf(Software_Integrity_Attack, Malicious_Software_Update).


parentOf(Malicious_Software_Update, Malicious_Automated Software_Update_via_Redirection).
parentOf(Malicious_Software_Update, Malicious_Manual_Software_Update).
parentOf(Malicious_Software_Update, Rooting_SIM_Cards).
parentOf(Malicious_Software_Update, Malicious_Automated_Software_Update_via_Spoofing).

parentOf(Modification_During_Manufacture, Development_Alteration).
parentOf(Modification_During_Manufacture, Design_Alteration).


parentOf(Development_Alteration, Malicious_Logic_Inserted_Into_Product_Software_by_Authorized_Developer).
parentOf(Development_Alteration, Malicious_Logic_Inserted_Into_Product_Software_via_Configuration_Menagement_Manipulation).
parentOf(Development_Alteration, Malicious_Logic_Insertion_Into_Product_Software_via_Inclusion_of_3rd_Party_Componente_Dependency).
parentOf(Development_Alteration, Infiltration_of_Software_Development_Environment).
parentOf(Development_Alteration, Hardware_Component_Substitution_During_Baselining).
parentOf(Development_Alteration, Counterfeit_Hardware_Component_Inserted_During_Product_Assembly).
parentOf(Development_Alteration, Altered_Installed_BIOS).
parentOf(Development_Alteration, Infiltration_of_Hardware_Development_Environment).
parentOf(Development_Alteration, Open_Source_Libraries_Altered).
parentOf(Development_Alteration, ASIC_with_Malicious_Functionality).

parentOf(Design_Alteration, Documentation_Alteration_to_Circumvent_Dial-down).
parentOf(Design_Alteration, Documentation_Alteration_to_Produce_Under-performing_Systems).
parentOf(Design_Alteration, Documentation_Alteration_to_Cause_Errors_in_System_Design).
parentOf(Design_Alteration, Hardware_Design_Specifications_Are_Altered).


parentOf(Manipulation_During_Distribution, Malicious_Hardware_Component_Replacement).
parentOf(Manipulation_During_Distribution, Malicious_Software_Implanted).
parentOf(Manipulation_During_Distribution, Rogue_Integration_Procedures).

parentOf(Hardware_Integrity_Attack, Physically_Hacking_Hardware).
parentOf(Hardware_Integrity_Attack, Malicious_Hardware_Update).

parentOf(Physically_Hacking_Hardware, Bypassing_ATA_Password_Security).

parentOf(Malicious_Hardware_Update, Hardware_Component_Substitution).

parentOf(Hardware_Component_Substitution,Provide_Counterfeit_Component).
parentOf(Hardware_Component_Substitution,Malicious_Gray_Market_Hardware).

parentOf(Malicious_Logic_Insertion,Infected_Software).
parentOf(Malicious_Logic_Insertion,Infected_Hardware).
parentOf(Malicious_Logic_Insertion,Infected_Memory).

parentOf(Infected_Software,Embed_Virus_into_DLL).

parentOf(Infected_Hardware, Altered_Component_Firmware).

parentOf(Infected_Memory,USB_Memory_Attacks).
parentOf(Infected_Memory,Flash_Memory_Attacks).


parentOf(Obstruction,Physical_Destruction_of_Device_or_Component).
parentOf(Obstruction,Route_Disabling).
parentOf(Obstruction,Jamming).
parentOf(Obstruction,Blockage).

parentOf(Route_Disabling, Disabling_Network_Hardware).
parentOf(Route_Disabling, BGP_Route_Disabling).
parentOf(Route_Disabling, DNS_Domain_Seizure).

parentOf(Jamming, Orbital_Jamming).
parentOf(Jamming, Wi-Fi_Jamming).
parentOf(Jamming, Cellular_Jamming).

parentOf(Blockage, Block_Access_to_Libraries).
parentOf(Blockage, DNS_Blocking).
parentOf(Blockage, IP_Address_Blocking).

%*****************************************************************************************
%****************************************SLABOSTI

weaknesses(Cache_Poisoning, Use_of_Less_Trusted_Source, High).
weaknesses(Cache_Poisoning, Insufficient_Verification_of_Data_Authenticity,High).
weaknesses(Cache_Poisoning, Acceptance_of_Extraneous_Untrusted_Data_With_Trusted_Data,High).
weaknesses(Cache_Poisoning, Origin_Validation_Error,High).
weaknesses(Cache_Poisoning, Unintended_Proxy_or_Intermediary,High).


weaknesses(DNS_Cache_Poisoning, Reliance_on_Reverse_DNS_Resolution_for_a_Security-Critical_Action, High).


weaknesses(Force_the_System_to_Reset_Values, Missing_Authentication_for_Critical_Function, Medium).
weaknesses(Force_the_System_to_Reset_Values, Improper_Lock_Behavior_After_Power_State_Transition, Medium).

weaknesses(Audit_Log_Manipulation, Improper_Output_Neutralization_for_Logs, Medium).


weaknesses(Web_Logs_Tampering, 	Improper_Neutralization_of_CRLF_Sequences, High).
weaknesses(Web_Logs_Tampering, 	Failure_to_Sanitize_Special_Elements_into_a_Different_Plane, High).
weaknesses(Web_Logs_Tampering, 	Information_Loss_or_Omission, High).
weaknesses(Web_Logs_Tampering, 	Static_Code_Injection, High).
weaknesses(Web_Logs_Tampering, 	Improper_Input_Validation, High).
weaknesses(Web_Logs_Tampering, 	Improper_Neutralization_of_Escape_Meta_or_Control_Sequences, High).
weaknesses(Web_Logs_Tampering, 	Incorrect_Default_Permissions, High).
weaknesses(Web_Logs_Tampering, 	Incorrect_Execution-Assigned_Permissions, High).
weaknesses(Web_Logs_Tampering, 	Improper_Encoding_or_Escaping_of_Output, High).


weaknesses(Log_Injection-Tampering-Forging, Improper_Output_Neutralization_for_Logs,High).
weaknesses(Log_Injection-Tampering-Forging, Failure_to_Sanitize_Special_Elements_into_a_Different_Plane,High).
weaknesses(Log_Injection-Tampering-Forging, Improper_Neutralization_of_Escape_Meta_or_Control_Sequences,High).
weaknesses(Log_Injection-Tampering-Forging, Improper_Output_Neutralization_for_Logs,High).

weaknesses(User-Controlled_Filename, Improper_Input_Validation,High).
weaknesses(User-Controlled_Filename, Incomplete_List_of_Disallowed_Inputs,High).
weaknesses(User-Controlled_Filename, Improper_Neutralization_of_Directives_in_Statically_Saved_Code,High).
weaknesses(User-Controlled_Filename, Improper_Encoding_or_Escaping_of_Output,High).
weaknesses(User-Controlled_Filename, Reliance_on_Reverse_DNS_Resolution_for_a_Security-Critical_Action,High).
weaknesses(User-Controlled_Filename, Improper_Neutralization_of_Invalid_Characters_in_Identifiers_in_Web_Pages,High).
weaknesses(User-Controlled_Filename, Incorrect_Comparison,High).


weaknesses(Alternative_Execution_Due_to_Deceptive_Filenames,Improper_Neutralization_of_Trailing_Special_Elements, High).

weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Improper_Control_of_Generation_of_Code, VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Improper_Neutralization_of_Directives_in_Statically_Saved_Code,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Improper_Neutralization_of_Directives_in_Dynamically_Evaluated_Code,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Improper_Neutralization_of_Server-Side_Includes_(SSI)_Within_a_Web_Page,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Least_Privilege_Violation,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Improper_Link_Resolution_Before_File_Access,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Improper_Ownership_Management,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Permission_Issues,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Permissions,_Privileges,_and_Access_Controls,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, Privilege_Context_Switching_Error,VeryHigh).
weaknesses(Leverage_Executable_Code_in_Non-Executable_Files, OWASP_Top_Ten_2007_Category_A3_-_Malicious_File_Execution,VeryHigh).


weaknesses(Windows_::DATA_Alternate_Data_Stream, Improper_Removal_of_Sensitive_Information_Before_Storage_or_Transfer, Medium).
weaknesses(Windows_::DATA_Alternate_Data_Stream, Improper_Handling_of_Windows_::DATA_Alternate_Data_Stream,Medium).

weaknesses(Configuration/Environment_Manipulation,External_Control_of_System_or_Configuration_Setting,Medium).
weaknesses(Configuration/Environment_Manipulation,Improper_Hardware_Lock_Protection_for_Security_Sensitive_Controls,Medium).
weaknesses(Configuration/Environment_Manipulation,Hardware_Internal_or_Debug_Modes_Allow_Override_of_Locks,Medium).

weaknesses(Manipulating_Writeable_Configuration_Files, Acceptance_of_Extraneous_Untrusted_Data_With_Trusted_Data,VeryHigh).
weaknesses(Manipulating_Writeable_Configuration_Files, Improper_Control_of_Resource_Identifiers,VeryHigh).
weaknesses(Manipulating_Writeable_Configuration_Files, Improper_Neutralization_of_Special_Elements_used_in_a_Command,VeryHigh).
weaknesses(Manipulating_Writeable_Configuration_Files, Origin_Validation_Error,VeryHigh).
weaknesses(Manipulating_Writeable_Configuration_Files, Missing_Support_for_Integrity_Check,VeryHigh).
weaknesses(Manipulating_Writeable_Configuration_Files, Improper_Validation_of_Integrity_Check_Value,VeryHigh).
weaknesses(Manipulating_Writeable_Configuration_Files, OWASP_Top_Ten_2007_Category_A2_-_Injection_Flaws,VeryHigh).


weaknesses(Manipulate_Registry_Information, External_Control_of_System_or_Configuration_Setting,Medium).


weaknesses(Poison_Web_Service_Registry, Improper_Authorization,VeryHigh).
weaknesses(Poison_Web_Service_Registry, Improper_Neutralization_of_Special_Elements_in_Output_Used_by_a_Downstream_Component,VeryHigh).
weaknesses(Poison_Web_Service_Registry, Protection_Mechanism_Failure,VeryHigh).



weaknesses(Modification_of_Registry_Run_Keys, External_Control_of_System_or_Configuration_Setting, Medium).


weaknesses(Modification_of_Windows_Service_Configuration, Improper_Access_Control, Low).

weaknesses(Schema_Poisoning, External_Control_of_System_or_Configuration_Setting, Low).


weaknesses(XML_Schema_Poisoning, External_Control_of_System_or_Configuration_Setting,Low).
weaknesses(XML_Schema_Poisoning, External_Control_of_Assumed-Immutable_Web_Parameter,Low).


weaknesses(Data_Injected_During_Configuration, External_Control_of_Assumed-Improper_Access_Control, Low).


weaknesses(Disable_Security_Software, Improper_Access_Control, Medium).

weaknesses(Software_Integrity_Attack, Download_of_Code_Without_Integrity_Check, Low).

weaknesses(Malicious_Software_Download, Download_of_Code_Without_Integrity_Check, VeryHigh).

weaknesses(Malicious_Software_Update, Download_of_Code_Without_Integrity_Check, High).

weaknesses(Malicious_Automated_Software_Update_via_Redirection, Download_of_Code_Without_Integrity_Check, High).

weaknesses(Malicious_Manual_Software_Update, Download_of_Code_Without_Integrity_Check, Low).

weaknesses(Rooting_SIM_Cards, Use_of_a_Broken_or_Risky_Cryptographic_Algorithm, High).

weaknesses(Malicious_Automated_Software_Update_via_Spoofing, Download_of_Code_Without_Integrity_Check, High).

weaknesses(Block_Access_to_Libraries, Call_to_Non-ubiquitous_API, Medium).
weaknesses(Block_Access_to_Libraries, 7PK - API Abuse, Medium).

weaknesses(DNS_Blocking, Channel_Accessible_by_Non-Endpoint, Medium).

weaknesses(IP_Address_Blocking, Channel_Accessible_by_Non-Endpoint, High).


%******************************************************************************************
%*********************PREDUSLOVI
prerequisites(Infrastructure_Manipulation,The_targeted_client_must_access_the_site_via_ infrastructure_that_the_attacker_has_co-opted).
prerequisites(Infrastructure_Manipulation,The_targeted_client_fail_to_adequately_verify_that_the_communication_channel_is_operating_correctly).


prerequisites(Cache_Poisoning,The_attacker_able_to_modify_the_value_stored_in_a_cache_to_match_a_desired_value).
prerequisites(Cache_Poisoning,The_targeted_application_not_able_to_detect_the_illicit_modification_of_the_cache).
prerequisites(Cache_Poisoning,The_targeted_application_trust_the_cache_value_in_its_calculations).

prerequisites(DNS_Cache_Poisoning,A_DNS_cache_vulnerable_to_some_attack_that_allows_the_adversary_to_replace_addresses_in_its_lookup_table).
prerequisites(DNS_Cache_Poisoning,Client_app_trust_the_corrupted_cashed_values_and_utilize_them).


prerequisites(Force_the_System_to_Reset_Values,The_targeted_application_have_a_reset_function_that_returns_the_configuration_of_the_application_to_an_earlier_state).
prerequisites(Force_the_System_to_Reset_Values,The_reset_functionality_must_be_inadequately_protected_against_use).


prerequisites(Audit_Log_Manipulation,The_target_host_is_logging_the_action_and_data_of_the_user).
prerequisites(Audit_Log_Manipulation,The_target_host_insufficiently_protects_access_to_the_logs_or_logging_mechanisms).


prerequisites(Web_Logs_Tampering,Target_server_software_is_a_HTTP_server_that_performs_web_logging).


prerequisites(Log_Injection-Tampering-Forging,The_target_host_is_logging_the_action_and_data_of_the_user).
prerequisites(Log_Injection-Tampering-Forging,The_target_host_insufficiently_protects_access_to_the_logs_or_logging_mechanisms).


prerequisites(Contradictory_Destinations_in_Traffic_Routing_Schemes,Adversary_is_aware_that_their_message_will_be_routed_using_a_CDN).

prerequisites(File_Manipulations,The_target_use_the_affected_file_without_verifying_its_integrity).
prerequisites(User-Controlled_Filename,The_victim_trusts_the_name_and_locale_of_user_controlled_filenames).

prerequisites(Alternative_Execution_Due_to_Deceptive_Filenames,The_use_of_the_file_must_be_controlled_by_the_file_extension).

prerequisites(Hiding_Malicious_Data_or_Code_within_Files,The_operating_system_must_support_a_file_system_that_allows_for_alternate_data_storage_for_a_file).

prerequisites(Leverage_Executable_Code_in_Non-Executable_Files,The_attacker_must_have_the_ability_to_modify_non-executable_files_consumed_by_the_target_software).


prerequisites(Windows_::DATA_Alternate_Data_Stream,The_target_must_be_running_the_Microsoft_NTFS_file_system).


prerequisites(Configuration/Environment_Manipulation,The_target_application_must_consult_external_files_or_configuration_controls_to_control_its_execution).
prerequisites(Configuration/Environment_Manipulation,All_but_the_very_simplest_applications_meet_this_requirement).



prerequisites(Manipulating_Writeable_Configuration_Files,Configuration_files_must_be_modifiable_by_the_attacker).

prerequisites(Manipulate_Registry_Information,The_targeted_application_must_rely_on_values_stored_in_a_registry).
prerequisites(Manipulate_Registry_Information,The_adversary_have_a_means_of_elevating_permissions).


prerequisites(Poison_Web_Service_Registry,The_attacker_must_be_able_to_write_to_resources_or_redirect_access_to_the_service_registry).


prerequisites(Modification_of_Registry_Run_Keys,The_adversary_must_have_gained_access_to_the_target_system_via_physical_or_logical_means_in_order_to_carry_out_this_attack).

prerequisites(Modification_of_Windows_Service_Configuration, The_adversary_must_have_the_capability_to_write_to_the_Windows_Registry_on_the_targeted_system).


prerequisites(Schema_Poisoning,Some_level_of_access_to_modify_the_target_schema).
prerequisites(Schema_Poisoning,The_schema_used_by_the_target_application_must_be_improperly_secured_against_unauthorized_modification_and_manipulation).


prerequisites(XML_Schema_Poisoning,Some_level_of_access_to_modify_the_target_schema).
prerequisites(XML_Schema_Poisoning,The_schema_used_by_the_target_application_must_be_improperly_secured_against_unauthorized_modification_and_manipulation).

prerequisites(Data_Injected_During_Configuration,The_attacker_must_have_previously_compromised_the_victim's_systems_or_have_physical_access_to_the_victim's_systems).
prerequisites(Data_Injected_During_Configuration,Advanced_knowledge_of_software_and_hardware_capabilities_of_a_manufacturer's_product).


prerequisites(Disable_Security_Software, The_adversary_must_have_the_capability_to_interact_with_the_configuration_of_the_targeted_system).

prerequisites(Malicious_Manual_Software_Update, Advanced_knowledge_about_the_download_and_update_installation_processes).
prerequisites(Malicious_Manual_Software_Update, Advanced_knowledge_about_the_deployed_system_and_its_various_software_subcomponents_and_processes).

prerequisites(Rooting_SIM_Cards, A_SIM_card_that_relies_on_the_DES_cipher).

prerequisites(Development_Alteration, Access_to_the_system_during_the_development_phase_to_alter_and/or_modify_software_and_hardware_components).

prerequisites(Design_Alteration, Access_to_system_design_documentation_prior_to_the_development_phase).
prerequisites(Design_Alteration, Ability_to_forge_web_communication_ to_deliver_modified_design_documentation).

prerequisites(Malicious_Logic_Inserted_Into_Product_Software_by_Authorized_Developer, Access_to_the_software_during_the_development_phase).
prerequisites(Malicious_Logic_Inserted_Into_Product_Software_via_Configuration_Menagement_Manipulation,Access_to_the_configuration_management_system_during_deployment_or_currently_deployed_at_a_victim_location, this_access_is_often_obtained_via_insider_access_or_by_leveraging_another_attack_pattern_to_gain_permissions_that_the_adversary_wouldn't_normally_have).

prerequisites(Malicious_Logic_Insertion_Into_Product_Software_via_Inclusion_of_3rd_Party_Componente_Dependency, Access_to_the_software_during_the_development_phase_obtained_via_insider_access_to_include_the_3rd_party_component_after_deployment).

prerequisites(Infiltration_of_Software_Development_Environment, The_victim_must_use_email_or_removable_media_from_systems_running_the_IDE).
prerequisites(Infiltration_of_Software_Development_Environment, The_victim_must_have_a_system_running_exploitable_applications_and/or_a_vulnerable_configuration_to_allow_for_initial_infiltration).

prerequisites(Infiltration_of_Software_Development_Environment, The_attacker_must_have_working_knowledge_of_some_the_components_involved_in_the_IDE_system_as_well_as_the_infrastructure).

prerequisites(Hardware_Component_Substitution_During_Baselining, The_attacker_will_need_either_physical_access_or_be_able_to_supply_malicious_hardware_components_to_the_product_development_facility).

prerequisites(Counterfeit_Hardware_Component_Inserted_During_Product_Assembly, The_attacker_will_need_either_physical_access_or_be_able_to_supply_malicious_hardware_components_to_the_product_development_facility).

prerequisites(Altered_Installed_BIOS, Advanced_knowledge_about_the_installed_target_system_design).
prerequisites(Altered_Installed_BIOS, Advanced_knowledge_about_the_download_and_update_installation_processes).
prerequisites(Altered_Installed_BIOS, Access_to_the_download_and_update_system(s)_used_to_deliver_BIOS_images).

prerequisites(Infiltration_of_Hardware_Development_Environment, The_victim_must_use_email_or_removable_media_from_systems_running_the_IDE).
prerequisites(Infiltration_of_Hardware_Development_Environment, The_victim_must_have_a_system_running_exploitable_applications_and/or_a_vulnerable_configuration_to_allow_for_initial_infiltration).
prerequisites(Infiltration_of_Hardware_Development_Environment, The_attacker_must_have_working_knowledge_of_some_the_components_involved_in_the_IDE_system).

prerequisites(Open_Source_Libraries_Altered, Access_to_the_open_source_code_base_being_used_by_the_manufacturer_in_a_system_being_developed_or_currently_deployed_at_a_victim_location).

prerequisites(ASIC_with_Malicious_Functionality, The_attacker_must_have_working_knowledge_of_some_the_components_involved_in_the_target_system).
prerequisites(ASIC_with_Malicious_Functionality, Advanced_knowledge_about_the_ASIC_installed_within_the_target_system).

prerequisites(Documentation_Alteration_to_Circumvent_Dial-down, Advanced_knowledge_of_internal_software_and_hardware_components_within_manufacturer's_development_environment).
prerequisites(Documentation_Alteration_to_Circumvent_Dial-down, Access_to_the_manufacturer's_documentation).


prerequisites(Documentation_Alteration_to_Produce_Under-performing_Systems, Advanced_knowledge_of_software_and_hardware_capabilities_of_a_manufacturer's_product).

prerequisites(Documentation_Alteration_to_Cause_Errors_in_System_Design, Advanced_knowledge_of_software_capabilities_of_a_manufacturer's_product).

prerequisites(Hardware_Design_Specifications_Are_Altered, Advanced_knowledge_of_hardware_capabilities_of_a_manufacturer's_product).
prerequisites(Hardware_Design_Specifications_Are_Altered, Access_to_the_manufacturer's_documentation).

prerequisites(Malicious_Hardware_Component_Replacement, Physical_access_to_the_system_after_it_has_left_the_manufacturer_but_before_it_is_deployed_at_the_victim_location).

prerequisites(Malicious_Software_Implanted, Physical_access_to_the_system_after_it_has_left_the_manufacturer_but_before_it_is_deployed_at_the_victim_location).
prerequisites(Rogue_Integration_Procedures, Physical_access_to_the_system_after_it_has_left_the_manufacturer_but_before_it_is_deployed_at_the_victim_location).

prerequisites(Bypassing_ATA_Password_Security, Access_to_the_system_containing_the_ATA_Drive_so_that_the_drive_can_be_physically_removed_from_the_system).

prerequisites(Hardware_Integrity_Attack, Influence_over_the_deployed_system_at_a_victim_location).


prerequisites(Hardware_Component_Substitution, Physical_access_to_the_system_or_the_integration_facility_where_hardware_components_are_kept).


prerequisites(Provide_Counterfeit_Component, Advanced_knowledge_about_the_target_system_and_sub-components).

prerequisites(Malicious_Gray_Market_Hardware, Physical_access_to_a_gray_market_reseller's_hardware_components_supply, or_the_ability_to_appear_as_a_gray_market_reseller_to_the_victim's_buyer).

prerequisites(Malicious_Logic_Insertion, Access_to_the_component_currently_deployed_at_a_victim_location).


prerequisites(Infected_Software, Access_to_the_software_currently_deployed_at_a_victim_location,this_access_is_often_obtained_by_leveraging_another_attack_pattern_to_gain_permissions_that_the_adversary_wouldn't_normally_have).

prerequisites(Embed_Virus_into_DLL, Access_to_the_software_currently_deployed_at_a_victim_location,this_access_is_often_obtained_by_leveraging_another_attack_pattern_to_gain_permissions_that_the_adversary_wouldn't_normally_have).

prerequisites(Infected_Hardware,Access_to_the_software_currently_deployed_at_a_victim_location).


prerequisites(Altered_Component_Firmware,Advanced_knowledge_about_the_installed_target_system_design).
prerequisites(Altered_Component_Firmware,Advanced_knowledge_about_the_download_and_update_installation_processes).
prerequisites(Altered_Component_Firmware,Access_to_the_download_and_update_system(s)_used_to_deliver_BIOS_images).

prerequisites(USB_Memory_Attacks,Some_level_of_physical_access_to_the_device
_being_attacked).
prerequisites(USB_Memory_Attacks,Information_pertaining_to_the_target_organization_on_how_to_best_execute_a_USB_Drop_Attack).

prerequisites(Route_Disabling,The_adversary_requires_knowledge_of_and_access_to_network_route).

prerequisites(Disabling_Network_Hardware,The_adversary_requires_physical_access_to_the_targeted_communications_equipment_which_may_be_spread_over_a_wide_area).

prerequisites(BGP_Route_Disabling,The_adversary_must_have_control_of_a_router_that_can_modify,drop, or_introduce_spoofed_BGP_updates,the_adversary_can_convince).


prerequisites(DNS_Domain_Seizure,This_attack_pattern_requires_that_the_adversary_has_cooperation_from_the_registrar_of_the_target_domain).

prerequisites(Orbital_Jamming,This_attack_requirest_the_knowledge_of_the_satellite's_coordinates_for_targeting).

prerequisites(Wi-Fi_Jamming,Lack_of_anti_jamfeatures_in_802.11).
prerequisites(Wi-Fi_Jamming,Lack_of_authentication_on_deauthentication/disassociation_packets_on_802.11-based networks).

prerequisites(Cellular_Jamming, Lack_of_authentication_on_deauthentication/disassociation_packets_on_802.11-based_networks).

prerequisites(Cellular_Jamming, Lack_of_authentication_on_deauthentication/disassociation_packets_on_802.11-based_networks).

prerequisites(Blockage, This_attack_pattern_requires_knowledge_of_where_important_system_resources_are_logically_located_as_well_as_how_they_operate).

prerequisites(Block_Access_to_Libraries,An_application_requires_access_to_external_libraries).
prerequisites(Block_Access_to_Libraries,An_attacker_has_the_privileges_to_block_application_access_to_external_libraries).

prerequisites(DNS_Blocking,This_attack_requires_the_ability_to_conduct_deep_packet_inspection_with_an_In-Path_device_that_can_drop_the_targeted_traffic_and/or_connection).

prerequisites(IP_Address_Blocking,This_attack_requires_the_ability_to_conduct_deep_packet_inspection_with_an_In-Path_device_that_can_drop_the_targeted_traffic_and/or connection).

%**********************************************************************************************************
%***********************************TOK IZVRSAVANJA
execution_flow(Cache_Poisoning,Explore,Identify_and_explore_caches).
execution_flow(Cache_Poisoning,Experiment,Cause_specific_data_to_be_cached).
execution_flow(Cache_Poisoning,Exploit,Redirect_users_to_malicious_website).



execution_flow(DNS_Cache_Poisoning,Explore,Explore_resolver_caches).
execution_flow(DNS_Cache_Poisoning,Experiment,Attempt_sending_crafted_records_to_DNS_cache).
execution_flow(DNS_Cache_Poisoning,Exploit,Redirect_users_to_malicious_website).


execution_flow(Web_Logs_Tampering,Explore,Determine_Application_Web_Server_Log_File_Format).
execution_flow(Web_Logs_Tampering,Experiment,Determine_Injectable_Content).
execution_flow(Web_Logs_Tampering,Exploit,Manipulate_Log_Files).


execution_flow(Log_Injection-Tampering-Forging,Explore,Determine_Application's_Log_File_Format).
execution_flow(Log_Injection-Tampering-Forging,Exploit,Manipulate_Log_Files).

execution_flow(Open_Source_Libraries_Altered, Explore, Determine_the_relevent_open-source_code_project_to_target).
execution_flow(Open_Source_Libraries_Altered, Experiment, Develop_a_malicious_contribution_plan).
execution_flow(Open_Source_Libraries_Altered, Exploit, Execute_the_malicious_contribution_plan).



execution_flow(USB_Memory_Attacks, Explore, Determine_Target_System).
execution_flow(USB_Memory_Attacks, Experiment, Develop_or_Obtain_malware_and_install_on_a_USB_device).
execution_flow(USB_Memory_Attacks, Exploit, Connect_or_deceive_ a_user_into_connecting_the_infected_USB_device).


execution_flow(Block_Access_to_Librariess, Explore, Determine_what_external_libraries_the_application_accesses).
execution_flow(Block_Access_to_Librariess, Experiment, Block_access_to_the_external_libraries_accessed_by_the_application).

%******************************************************************************************************
%************************MERE UBLAZAVANJA

mitigations(Cache_Poisoning, Configuration, Disable_client_side_caching).
mitigations(Cache_Poisoning, Implementation,Listens_for_query_replies_on_a_network_and_sends_a_notification_via_email_when_an_entry_changes).


mitigations(DNS_Cache_Poisoning, Configuration, DNS_servers_updated_to_the_latest_versions).
mitigations(DNS_Cache_Poisoning, Configuration,UNIX_services_are_susceptible_to_wrong_information_being_held_in_a_cache).
mitigations(DNS_Cache_Poisoning, Configuration, Disable_client_side_DNS_caching).



mitigations(Web_Logs_Tampering, Design, Use_input_validation_before_writing_to_web_log).
mitigations(Web_Logs_Tampering, Design, Validate_all_log_data_before_it_is_output).


mitigations(Log_Injection-Tampering-Forging, _, Carefully_control_access_to_physical_log_files).
mitigations(Log_Injection-Tampering-Forging, _, Do_not_allow_tainted_data_to_be_written_in_the_log_file_without_prior_input_validation).
mitigations(Log_Injection-Tampering-Forging, _, Use_synchronization_to_control_the_flow_of_execution).
mitigations(Log_Injection-Tampering-Forging, _, Use_static_analysis_tools_to_identify_log_forging_vulnerabilities).
mitigations(Log_Injection-Tampering-Forging, _, Avoid_viewing_logs_with_tools_such_as_command-line_shells).




mitigations(Contradictory_Destinations_in_Traffic_Routing_Schemes, _, Monitor_connections).
mitigations(Contradictory_Destinations_in_Traffic_Routing_Schemes, _, Checking_headers_in_traffic).


mitigations(User-Controlled_Filename, Design,  Use_browser_technologies_that_do_not_allow_client_side_scripting).
mitigations(User-Controlled_Filename, Implementation,Ensure_all_content_that_is_delivered_to_client_is_sanitized_against_an_acceptable_content_specification).
mitigations(User-Controlled_Filename, Implementation, Perform_input_validation_for_all_remote_content).
mitigations(User-Controlled_Filename, Implementation, Perform_output_validation_for_all_remote_content).
mitigations(User-Controlled_Filename, Implementation, Disable_scripting_languages_such_as_JavaScript_in_browser).
mitigations(User-Controlled_Filename, Implementation, Scan_dynamically_generated_content_against_validation_specification).



mitigations(Alternative_Execution_Due_to_Deceptive_Filenames, _, Applications_insure_that_the_content_of_the_file_is_consistent_with_format_it_is_expecting).
mitigations(Alternative_Execution_Due_to_Deceptive_Filenames, _, Applications_insure_that_the_content_of_the_file_doesn't_depend_solely_on_the_file_extension).


mitigations(Hiding_Malicious_Data_or_Code_within_Files, _, Many_tools_are_available_to_search_for_the_hidden_data).
mitigations(Hiding_Malicious_Data_or_Code_within_Files, _, Scan_regularly_for_such_data_using_one_of_these_tools).


mitigations(Leverage_Executable_Code_in_Non-Executable_Files,Design,Enforce_principle_of_least_privilege).
mitigations(Leverage_Executable_Code_in_Non-Executable_Files,Design,Run_server_interfaces_with_a_non-root_account_and/or_utilize_chroot_jails_or_other_configuration_techniques_to_constrain_privileges_even_if_attacker_gains_some_limited_access_to_commands).
mitigations(Leverage_Executable_Code_in_Non-Executable_Files,Implementation,Perform_testing_such_as_pen-testing_and_vulnerability_scanning_to_identify_directories,_programs,_and_interfaces_that_grant_direct_access_to_executables).
mitigations(Leverage_Executable_Code_in_Non-Executable_Files,Implementation,Implement_host_integrity_monitoring_to_detect_any_unwanted_altering_of_configuration_files).
mitigations(Leverage_Executable_Code_in_Non-Executable_Files,Implementation,Ensure_that_files_that_are_not_required_to_execute,_such_as_configuration_files,_are_not_over-privileged,_i.e._not_allowed_to_execute).



mitigations(Windows_::DATA_Alternate_Data_Stream, Design, Use_FAT_file_systems_which_do_not_support_Alternate_Data_Streams).
mitigations(Windows_::DATA_Alternate_Data_Stream, Implementation, Use_Vista_dir_with_the_-R_switch_or_utility_to_find_Alternate_Data_Streams_and_take_appropriate_action_with_those_discovered).
mitigations(Windows_::DATA_Alternate_Data_Stream, Implementation, Use_products_that_are_Alternate_Data_Stream_aware_for_virus_scanning_and_system_security_operations).





mitigations(Manipulating_Writeable_Configuration_Files,Design,Enforce_principle_of_least_privilege).
mitigations(Manipulating_Writeable_Configuration_Files,Design,Backup_copies_of_all_configuration_files).
mitigations(Manipulating_Writeable_Configuration_Files,Implementation,Integrity_monitoring_for_configuration_files).
mitigations(Manipulating_Writeable_Configuration_Files,Implementation,Enforce_audit_logging_on_code_and_configuration_promotion_procedures).
mitigations(Manipulating_Writeable_Configuration_Files,Implementation,Load_configuration_from_separate_process_and_memory_space,_for_example_a_separate_physical_device_like_a_CD).





mitigations(Manipulate_Registry_Information, _, Ensure_proper_permissions_are_set_for_Registry_hives_to_prevent_users_from_modifying_keys).
mitigations(Manipulate_Registry_Information, _, Employ_a_robust_and_layered_defensive_posture_in_order_to_prevent_unauthorized_users_on_your_system).
mitigations(Manipulate_Registry_Information, _, Employ_robust_identification_and_audit/blocking_using_an_allowlist_of_applications_on_your_system).
mitigations(Manipulate_Registry_Information, _, Unnecessary_applications,_utilities,_and_configurations_will_have_a_presence_in_the_system_registry_that_can_be_leveraged_by_an_adversary_through_this_attack_pattern).


mitigations(Poison_Web_Service_Registry, Design, Enforce_principle_of_least_privilege).
mitigations(Poison_Web_Service_Registry, Design, Harden_registry_server_and_file_access_permissions).
mitigations(Poison_Web_Service_Registry, Implementation, Implement_communications_to_and_from_the_registry_using_secure_protocols).




mitigations(Modification_of_Registry_Run_Keys,_,Identify_programs_that_may_be_used_to_acquire_process_information_and_block_them_by_using_a_software_restriction_policy_or_tools_that_restrict_program_execution_by_using_a_process_allowlist).



mitigations(Modification_of_Windows_Service_Configuration, _, Ensure_proper_permissions_are_set_for_Registry_hives_to_prevent_users_from_modifying_keys_for_system_components_that_may_lead_to_privilege_escalation).



mitigations(Schema_Poisoning, Design, Protect_the_schema_against_unauthorized_modification).
mitigations(Schema_Poisoning, Implementation, For_applications_that_use_a_known_schema,_use_a_local_copy_or_a_known_good_repository_instead_of_the_schema_reference_supplied_in_the_schema_document).
mitigations(Schema_Poisoning, Implementation, For_applications_that_leverage_remote_schemas,_use_the_HTTPS_protocol_to_prevent_modification_of_traffic_in_transit_and_to_avoid_unauthorized_modification).



mitigations(XML_Schema_Poisoning, Design, Protect_the_schema_against_unauthorized_modification).
mitigations(XML_Schema_Poisoning, Implementation, or_applications_that_use_a_known_schema,_use_a_local_copy_or_a_known_good_repository_instead_of_the_schema_reference_supplied_in_the_XML_document).
mitigations(XML_Schema_Poisoning, Implementation,ensure_that_the_proper_permissions_are_set_on_local_files_to_avoid_unauthorized_modification).
mitigations(XML_Schema_Poisoning, Implementation,For_applications_that_leverage_remote_schemas,_use_the_HTTPS_protocol_to_prevent_modification_of_traffic_in_transit_and_to_avoid_unauthorized_modification).


mitigations(Data_Injected_During_Configuration, _, Ensure_that_proper_access_control_is_implemented_on_all_systems_to_prevent_unauthorized_access_to_system_files_and_processes).

mitigations(Disable_Security_Software, _, Ensure_proper_permissions_are_in_place_to_prevent_adversaries_from_altering_the_execution_status_of_security_tools).


mitigations(Malicious_Software_Update, _, Validate_software_updates_before_installing).



mitigations(Rooting_SIM_Cards, _, Upgrade_the_SIM_card_to_use_the_state-of-the-art_AES_or_the_somewhat_outdated_3DES_algorithm_for_OTA).


mitigations(Development_Alteration, Assess_software_and_software_components_during_development_and_prior_to_deployment_to_ensure_that_they_function_as_intended_and_without_any_malicious_functionality).

mitigations(Design_Alteration, Assess_design_documentation_prior_to_development_to_ensure_that_they_function_as_intended_and_without_any_malicious_functionality).
mitigations(Design_Alteration, Ensure_that_design_documentation_is_saved_in_a_secure_location_and_has_proper
_access_control_set_in_place_to_avoid_unnecessary_modification).


mitigations(Malicious_Logic_Inserted_Into_Product_Software_by_Authorized_Developer,Assess_software_during_development_and_prior_to_deployment_to_ensure_that_it_functions_as_intended_and_without_any_malicious_functionality.).
mitigations(Malicious_Logic_Inserted_Into_Product_Software_via_Configuration_Menagement_Manipulation,Assess_software_during_development_and_prior_to_deployment_to_ensure_that_it_functions_as_intended_and_without_any_malicious_functionality).
mitigations(Malicious_Logic_Inserted_Into_Product_Software_via_Configuration_Menagement_Manipulation,Leverage_anti-virus_products_to_detect_and_quarantine_software_with_known_virus).
mitigations(Malicious_Logic_Insertion_Into_Product_Software_via_Inclusion_of_3rd_Party_Componente_Dependency,Assess_software_during_development_and_prior_to_deployment_to_ensure_that_it_functions_as_intended_and_without_any_malicious_functionality).

mitigations(Infected_Software,Leverage_anti-virus_products_to_detect_and_quarantine_software_with_known_virus).

mitigations(Embed_Virus_into_DLL
,Leverage_anti-virus_products_to_detect_and_quarantine_software_with_known_virus).

mitigations(Infected_Memory,Leverage_anti-virus_products_to_detect_stop_operations_with_known_virus).

mitigations(USB_Memory_Attacks,Ensure_that_proper,physical_system_access_is_regulated_to_prevent_an_adversary_from_physically_connecting_a_alicious_USB_device_themself).

mitigations(Disabling_Network_Hardware,Ensure_rigorous_physical_defensive_measures_to_keep_the_adversary_from_accessing_critical_systems).

mitigations(BGP_Route_Disabling, Implement_Ingress_filters_to_check_the_validity_of_received_routes).
mitigations(BGP_Route_Disabling, Implement_Secure_BGP_(S-BGP protocol),which_improves_authorization_and_authentication_capabilities_based_on_public-key_cryptography).

mitigations(BGP_Route_Disabling, Implement_Secure_BGP_(S-BGP protocol),which_improves_authorization_and_authentication_capabilities_based_on_public-key_cryptography).

mitigations(Wi-Fi_Jamming,Commercial_products+are_not_currently_available_that_support_jamming_countermeasures_for_Wi-Fi).

mitigations(Cellular_Jamming,Mitigating_this_attack_requires_countermeasures_employed_on_both_the_retransmission_device_as_well_as_on_the_cell_tower,therefore,any_system_that_relies_on_existing_commercial_cell_towards_will_likely_be_vulnerable_to_this_attack).


mitigations(Block_Access_to_Libraries, Ensure_that_application_handles_situations_where_access_to_APIs_in_external_libraries_is_not_available_securely).



mitigations(DNS_Blocking, Hard_Coded_Alternate_DNS_server_in_applications).
mitigations(DNS_Blocking, Avoid_dependence_on_DNS).
mitigations(DNS_Blocking, Include_"hosts file"/IP_address_in_the_application).
mitigations(DNS_Blocking, Use_a .onion_domain_with_Tor_support).

%**************************************************************************************************************************************************************************************************
%**************************************************************************************************************************************************************************************************
%**************************************************************************************************************************************************************************************************
%**************************************************************************************************************************************************************************************************
%SUBVERT ACCESS CONTROL


parentOf(Subvert_Access_Control, Exploitation_of_Trusted_Identifiers).
parentOf(Subvert_Access_Control, Exploiting_Trust_in_Client).
parentOf(Subvert_Access_Control, Man_in_the_Middle_Attack).
parentOf(Subvert_Access_Control, Authentication_Abuse).
parentOf(Subvert_Access_Control, Authentication_Bypass).
parentOf(Subvert_Access_Control, Privilege_Abuse).
parentOf(Subvert_Access_Control, Privilege_Escalation).
parentOf(Subvert_Access_Control, Bypassing_Physical_Security).
parentOf(Subvert_Access_Control, Physical_Theft).
parentOf(Subvert_Access_Control, Use_of_Known_Domain_Credentials).

parentOf(Exploitation_of_Trusted_Identifiers, Cross_Site_Request_Forgery).
parentOf(Exploitation_of_Trusted_Identifiers, Session_Credential_Falsification_through_Forging).
parentOf(Exploitation_of_Trusted_Identifiers, SaaS_User_Request_Forgery).
parentOf(Exploitation_of_Trusted_Identifiers, Session_Hijacking).

parentOf(Exploiting_Trust_in_Client, Manipulating_Opaque_Client-based_Data_Tokens).
parentOf(Exploiting_Trust_in_Client, Manipulating_User-Controlled_Variables).
parentOf(Exploiting_Trust_in_Client, Create_Malicious_Client).
parentOf(Exploiting_Trust_in_Client, Removing_Important_Client_Functionality).

parentOf(Man_in_the_Middle_Attack, XML_Routing_Detour_Attacks).
parentOf(Man_in_the_Middle_Attack, Application_API_Message_Manipulation_via_Man-in-the-Middle).
parentOf(Man_in_the_Middle_Attack, Application_API_Navigation_Remapping).
parentOf(Man_in_the_Middle_Attack, Leveraging_Active_Man_in_the_Middle_Attacks_to_Bypass_Same_Origin_Policy).

parentOf(Authentication_Abuse, Reflection_Attack_in_Authentication_Protocol).
parentOf(Authentication_Abuse, Unauthorized_Use_of_Device_Resources).

parentOf(Authentication_Bypass, Forceful_Browsing).
parentOf(Authentication_Bypass, Web_Services_API_Signature_Forgery_Leveraging_Hash_Function_Extension_Weakness).
parentOf(Authentication_Bypass, Escaping_Virtualization).

parentOf(Privilege_Abuse, Accessing_Functionality_Not_Properly_Constrained_by_ACLs).
parentOf(Privilege_Abuse, Using_Malicious_Files).
parentOf(Privilege_Abuse, Exploiting_Incorrectly_Configured_Access_Control_Security_Levels).
parentOf(Privilege_Abuse, Data_Serialization_External_Entities_Blowup).
parentOf(Privilege_Abuse, WebView_Exposure).

parentOf(Privilege_Escalation, Hijacking_a_Privileged_Thread_of_Execution).
parentOf(Privilege_Escalation, Subvert_Code-signing_Facilities).
parentOf(Privilege_Escalation, Target_Programs_with_Elevated_Privileges).
parentOf(Privilege_Escalation, Cross_Zone_Scripting).
parentOf(Privilege_Escalation, Hijacking_a_privileged_process).

parentOf(Bypassing_Physical_Security, Bypassing_Physical_Locks).
parentOf(Bypassing_Physical_Security, Bypassing_Electronic_Locks_and_Access_Controls).

parentOf(Physical_Theft, Physical_Security).
parentOf(Physical_Theft, Subvert_Access_Control).

parentOf(Use_of_Known_Domain_Credentials, Remote_Services_with_Stolen_Credentials).
parentOf(Use_of_Known_Domain_Credentials, Credential_Stuffing).
parentOf(Use_of_Known_Domain_Credentials, Use_of_Known_Kerberos_Credentials).
parentOf(Use_of_Known_Domain_Credentials, Use_of_Known_Windows_Credentials).



parentOf(Cross_Site_Request_Forgery, Cross_Site_Identification).

parentOf(Session_Credential_Falsification_through_Forging, Session_Credential_Falsification_through_Prediction).
parentOf(Session_Credential_Falsification_through_Forging, Session_Credential_Falsification_through_Manipulation).

parentOf(Session_Hijacking, Reusing_Session_IDs(aka_Session_Replay)).
parentOf(Session_Hijacking, Session_Fixation).
parentOf(Session_Hijacking, Session_Sidejacking).
parentOf(Session_Hijacking, Cross_Site_Tracing).

parentOf(Manipulating_Opaque_Client-based_Data_Tokens, Accessing/Intercepting/Modifying_HTTP_Cookies).

parentOf(Manipulating_User-Controlled_Variables, Subverting_Environment_Variable_Values).
parentOf(Manipulating_User-Controlled_Variables, Manipulating_Hidden_Fields).

parentOf(Removing_Important_Client_Functionality, Removal_of_filters:_Input_filters,_output_filters,_data_masking).
parentOf(Removing_Important_Client_Functionality, Removing/short-circuiting_'Purse'_logic:_removing/mutating_'cash'_decrements).

parentOf(Application_API_Message_Manipulation_via_Man-in-the-Middle, Transaction_or_Event_Tampering_via_Application_API_Manipulation).
parentOf(Application_API_Message_Manipulation_via_Man-in-the-Middle, Content_Spoofing_Via_Application_API_Manipulation).

parentOf(Application_API_Navigation_Remapping, Navigation_Remapping_To_Propagate_Malicious_Content).
parentOf(Application_API_Navigation_Remapping, Application_API_Button_Hijacking).

parentOf(Escaping_Virtualization, Escaping_a_Sandbox_by_Calling_Code_in_Another_Language).

parentOf(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs, Restful_Privilege_Elevation).

parentOf(Using_Malicious_Files, Create_files_with_the_same_name_as_files_protected_with_a_higher_classification).
parentOf(Using_Malicious_Files, Force_Use_of_Corrupted_Files).
parentOf(Using_Malicious_Files, Modify_Shared_File).
parentOf(Using_Malicious_Files, Add_Malicious_File_to_Shared_Webroot).
parentOf(Using_Malicious_Files, Replace_Binaries).
parentOf(Using_Malicious_Files, Upload_a_Web_Shell_to_a_Web_Server).

parentOf(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels, Restful_Privilege_Elevation).

parentOf(Privilege_Escalation, Hijacking_a_Privileged_Thread_of_Execution).
parentOf(Privilege_Escalation, Subvert_Code-signing_Facilities).
parentOf(Privilege_Escalation, Target_Programs_with_Elevated_Privileges).
parentOf(Privilege_Escalation, Cross_Zone_Scripting).
parentOf(Privilege_Escalation, 	Hijacking_a_privileged_process).


parentOf(Subvert_Code-signing_Facilities, Signing_Malicious_Code).
parentOf(Bypassing_Physical_Security, Bypassing_Physical_Locks).
parentOf(Bypassing_Physical_Security,Bypassing_Electronic_Locks_and_Access_Controls).

parentOf(Bypassing_Physical_Locks, 	Lock_Bumping).
parentOf(Bypassing_Physical_Locks, 	Lock_Picking).
parentOf(Bypassing_Physical_Locks, 	Using_a_Snap_Gun_Lock_to_Force_a_Lock).


parentOf(Bypassing_Electronic_Locks_and_Access_Controls, Cloning_Magnetic_Strip_Cards).
parentOf(Bypassing_Electronic_Locks_and_Access_Controls, Magnetic_Strip_Card_Brute_Force_Attacks).
parentOf(Bypassing_Electronic_Locks_and_Access_Controls, Cloning_RFID_Cards_or_Chips).
parentOf(Bypassing_Electronic_Locks_and_Access_Controls, RFID_Chip_Deactivation_or_Destruction).
parentOf(Bypassing_Electronic_Locks_and_Access_Controls, Smudge_Attack).


parentOf(Use_of_Known_Domain_Credentials, Remote_Services_with_Stolen_Credentials).
parentOf(Use_of_Known_Domain_Credentials, Credential_Stuffing).
parentOf(Use_of_Known_Domain_Credentials, Use_of_Known_Kerberos_Credentials).
parentOf(Use_of_Known_Domain_Credentials, Use_of_Known_Windows_Credentials).

parentOf(Use_of_Known_Kerberos_Credentials,Kerberoasting).
parentOf(Use_of_Known_Kerberos_Credentials,Use_of_Captured_Tickets).

parentOf(Use_of_Captured_Tickets, Remote_Services_with_Stolen_Credentials).
parentOf(Use_of_Captured_Tickets, Credential_Stuffing).
parentOf(Use_of_Captured_Tickets, Use_of_Known_Kerberos_Credentials).
parentOf(Use_of_Captured_Tickets, Use_of_Known_Windows_Credentials).

parentOf(Use_of_Known_Windows_Credentials, Windows_Admin_Shares_with_Stolen_Credentials).
parentOf(Use_of_Known_Windows_Credentials, Use_of_Captured_Hashes).

%***************************************************************************************************************************************
%********************SLABOSTI

weaknesses(Exploitation_of_Trusted_Identifiers, Authentication_Bypass_by Spoofing, High).
weaknesses(Exploitation_of_Trusted_Identifiers, Authentication_Bypass_by_Assumed-Immutable_Data, High).
weaknesses(Exploitation_of_Trusted_Identifiers, Origin_Validation_Error, High).
weaknesses(Exploitation_of_Trusted_Identifiers, Use_of_Persistent_Cookies_Containing_Sensitive_Information, High).
weaknesses(Exploitation_of_Trusted_Identifiers, J2EE_Misconfiguration:Insufficient_Session-ID_Length).
weaknesses(Exploitation_of_Trusted_Identifiers, Session_Fixation, High).
weaknesses(Exploitation_of_Trusted_Identifiers, Improper_Control_of_a_Resource_Through_its_Lifetime, High).
weaknesses(Exploitation_of_Trusted_Identifiers, Client-Side_Enforcement_of_Server-Side_Security, High).
weaknesses(Exploitation_of_Trusted_Identifiers, External_Control_of_Critical_State_Data, High).

weaknesses(Exploiting_Trust_in_Client, Authentication_Bypass_by_Spoofing, Low).
weaknesses(Exploiting_Trust_in_Client, Improper_Authentication, Low).
weaknesses(Exploiting_Trust_in_Client, Improper_Input_Validation, Low).
weaknesses(Exploiting_Trust_in_Client, Exposure_of_Sensitive_Information_to_an_Unauthorized_Actor, Low).
weaknesses(Exploiting_Trust_in_Client, Protection_Mechanism_Failure, Low).

weaknesses(Man_in_the_Middle_Attack, Removing_Important_Client_Functionality, Medium).
weaknesses(Man_in_the_Middle_Attack, Authentication_Bypass_by_Spoofing, Medium).
weaknesses(Man_in_the_Middle_Attack, Authentication_Bypass:OpenSSL_CTX_Object_Modified_after_SSL_Objects_are_Created, Medium).
weaknesses(Man_in_the_Middle_Attack, Improper_Authentication, Medium).
weaknesses(Man_in_the_Middle_Attack, Authentication_Bypass_by_Capture-replay, Medium).
weaknesses(Man_in_the_Middle_Attack, OWASP_Top_Ten_2004_Category_A3-Broken_Authentication_and_Session_Management, Medium).

weaknesses(Authentication_Abuse, Improper_Authentication, VeryHigh).
weaknesses(Authentication_Abuse, Improper_Access_to_Sensitive_Information_Using_Debug_and_Test_Interfaces, VeryHigh).

weaknesses(Authentication_Bypass, Improper_Authentication, Low).

weaknesses(Privilege_Abuse, Improper_Privilege_Management, Medium).
weaknesses(Privilege_Abuse, Incorrect_Permission_Assignment_for_Critical_Resource, Medium).
weaknesses(Privilege_Abuse, Missing_Security_Checks_in_Fabric_Bridge, Medium).

weaknesses(Privilege_Escalation,Improper_Privilege_Management, High).
weaknesses(Privilege_Escalation,Hardware_Logic_with_Insecure_De-Synchronization_between_Control_and_Data_Channels, High).
weaknesses(Privilege_Escalation,Improper_Translation_of_Security_Attributes_by_Fabric_Bridge, High).

weaknesses(Use_of_Known_Domain_Credentials, Insufficiently_Protected_Credentials, Medium).
weaknesses(Use_of_Known_Domain_Credentials, Improper_Restriction_of_Excessive_Authentication_Attempts, Medium).
weaknesses(Use_of_Known_Domain_Credentials, Use_of_Single-factor_Authentication, Medium).
weaknesses(Use_of_Known_Domain_Credentials, Use_of_Password_System_for_Primary_Authentication,Medium).
weaknesses(Use_of_Known_Domain_Credentials, Use_of_Single-factor_Authentication,Medium).
weaknesses(Use_of_Known_Domain_Credentials,Use_of_Password_System_for_Primary_Authentication,Medium).
weaknesses(Use_of_Known_Domain_Credentials, Not_Using_Password_Aging,Medium).
weaknesses(Use_of_Known_Domain_Credentials, Password_Aging_with_Long_Expiration,Medium).
weaknesses(Use_of_Known_Domain_Credentials, Reliance_on_a_Single_Factor_in_a_Security_Decision,Medium).
weaknesses(Use_of_Known_Domain_Credentials, Device_Unlock_Credential_Sharing,Medium).

weaknesses(Cross_Site_Request_Forgery, Cross-Site_Request_Forgery(CSRF), Low).
weaknesses(Cross_Site_Request_Forgery, Missing_Authentication_for_Critical_Function,Low).
weaknesses(Cross_Site_Request_Forgery, Improper_Control_of_a_Resource_Through_its_Lifetime,Low).
weaknesses(Cross_Site_Request_Forgery, Incorrect_Permission_Assignment_for_Critical_Resource,Low).
weaknesses(Cross_Site_Request_Forgery, OWASP_Top_Ten_2007_Category_A5-Cross_Site_Request_Forgery(CSRF),Low).
weaknesses(Cross_Site_Request_Forgery, Sensitive_Cookie_with_Improper_SameSite_Attribute,Low).

weaknesses(Cross_Site_Identification, Cross-Site_Request_Forgery(CSRF),Low).
weaknesses(Cross_Site_Identification, Exposure_of_Private_Personal_Information_to_an_Unauthorized_Actor,Low).

weaknesses(Session_Credential_Falsification_through_Forging, Session_Fixation,VeryHigh).
weaknesses(Session_Credential_Falsification_through_Forging, Improper_Control_of_a_Resource_Through_its_Lifetime,VeryHigh).

weaknesses(Session_Credential_Falsification_through_Prediction, Authentication_Bypass_by_Spoofing,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Use_of_Insufficiently_Random_Values,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Insufficient_Entropy,High ).
weaknesses(Session_Credential_Falsification_through_Prediction, Origin_Validation_Error,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Exposure_of_Data_Element_to_Wrong_Session,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Use_of_Persistent_Cookies_Containing_Sensitive_Information,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Exposure_of_Sensitive_Information_to_an_Unauthorized_Actor,High).
weaknesses(Session_Credential_Falsification_through_Prediction, J2EE_Misconfiguration:Insufficient_Session-ID_Length,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Improper_Authorization,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Session_Fixation,High).
weaknesses(Session_Credential_Falsification_through_Prediction, Protection_Mechanism_Failure,High).
weaknesses(Session_Credential_Falsification_through_Prediction, OWASP_Top_Ten_2007_Category_A8-Insecure_Cryptographic_Storage,High).

weaknesses(Session_Credential_Falsification_through_Manipulation, Reliance_on_Cookies_without_Validation_and_Integrity_Checking,High).
weaknesses(Session_Credential_Falsification_through_Manipulation, External_Control_of_Assumed-Immutable_Web_Parameter,High).

weaknesses(SaaS_User_Request_Forgery, Origin_Validation_Error, Low).

weaknesses(Session_Hijacking, Improper_Authentication, Medium).

weaknesses(Reusing_Session_IDs(aka_Session_Replay), Authentication_Bypass_by_Capture-replay, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Authentication_Bypass_by_Spoofing, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Origin_Validation_Error, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Session_Fixation, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Exposure_of_Data_Element_to_Wrong_Session, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Use_of_Persistent_Cookies_Containing_Sensitive_Information, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Exposure_of_Sensitive_Information_to_an_Unauthorized_Actor, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Improper_Authorization, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Improper_Control_of_a_Resource_Through_its_Lifetime, Medium).
weaknesses(Reusing_Session_IDs(aka_Session_Replay), Incorrect_Permission_Assignment_for_Critical_Resource, Medium).

weaknesses(Session_Fixation, Session_Fixation, Low).
weaknesses(Session_Fixation, 7PK-Time_and_State).
weaknesses(Session_Fixation, Improper_Control_of_a_Resource_Through_its_Lifetime,Low).
weaknesses(Session_Fixation, Incorrect_Permission_Assignment_for_Critical_Resource,Low).

weaknesses(Session_Sidejacking, Authentication_Bypass_by_Capture-replay,Medium).
weaknesses(Session_Sidejacking, Insufficiently_Protected_Credentials,Medium).
weaknesses(Session_Sidejacking, Unprotected_Transport_of_Credentials,Medium).
weaknesses(Session_Sidejacking, Cleartext_Transmission_of_Sensitive_Information,Medium).
weaknesses(Session_Sidejacking, Sensitive_Cookie_in_HTTPS_Session_Without_'Secure'_Attribute,Medium).

weaknesses(Cross_Site_Tracing, Protection_Mechanism_Failure, VeryHigh).
weaknesses(Cross_Site_Tracing, Incorrect_Use_of_Privileged_APIs,VeryHigh).

weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Improper_Authorization, Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Authentication_Bypass_by_Assumed-Immutable_Data,Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, External_Control_of_Assumed-Immutable_Web_Parameter,Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Reliance_on_Cookies_without_Validation_and_Integrity_Checking,Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Cleartext_Storage_of_Sensitive_Information_in_a_Cookie,Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Use_of_Persistent_Cookies_Containing_Sensitive_Information,Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Session_Fixation,Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Improper_Handling_of_Parameters,Low).
weaknesses(Manipulating_Opaque_Client-based_Data_Tokens, Missing_Support_for_Integrity_Check,Low).

weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Reliance_on_Cookies_without_Validation_and_Integrity_Checking, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Authentication_Bypass_by_Assumed-Immutable_Data, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Missing_Encryption_of_Sensitive_Data, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Improper_Neutralization_of_CRLF_Sequences_in_HTTP_Headers_('HTTP_Response_Splitting'), Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Use_of_Persistent_Cookies_Containing_Sensitive_Information, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Improper_Input_Validation, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Cleartext_Storage_of_Sensitive_Information_in_a_Cookie, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Session_Fixation, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, External_Control_of_Assumed-Immutable_Web_Parameter, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, OWASP_Top_Ten_2004_Category_A3_-_Broken_Authentication_and_Session_Management, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, Client-Side_Enforcement_of_Server-Side_Security, Medium).
weaknesses(Accessing/Intercepting/Modifying_HTTP_Cookies, External_Control_of_Critical_State_Data, Medium).

weaknesses(Manipulating_User-Controlled_Variables, External_Control_of_System_or_Configuration_Setting, Low).
weaknesses(Manipulating_User-Controlled_Variables, Improper_Control_of_Generation_of_Code_('Code_Injection'), Low).
weaknesses(Manipulating_User-Controlled_Variables, Improper_Neutralization_of_Directives_in_Statically_Saved_Code_('Static_Code_Injection'), Low).
weaknesses(Manipulating_User-Controlled_Variables, Improper_Authorization, Low).
weaknesses(Manipulating_User-Controlled_Variables, Authentication_Bypass_by_Assumed-Immutable_Data, Low).
weaknesses(Manipulating_User-Controlled_Variables, PHP_External_Variable_Modification, Low).
weaknesses(Manipulating_User-Controlled_Variables, Improperly_Controlled_Modification_of_Object_Prototype_Attributes_('Prototype_Pollution'), Low).

weaknesses(Subverting_Environment_Variable_Values, Missing_Support_for_Integrity_Check, Medium).
weaknesses(Subverting_Environment_Variable_Values, Improper_Authorization,Medium).
weaknesses(Subverting_Environment_Variable_Values, Authentication_Bypass_by_Assumed-Immutable_Data,Medium).
weaknesses(Subverting_Environment_Variable_Values, Improper_Neutralization_of_Special_Elements_in_Output_Used_by_a_Downstream_Component_('Injection'),Medium).
weaknesses(Subverting_Environment_Variable_Values, External_Control_of_System_or_Configuration_Setting,Medium).
weaknesses(Subverting_Environment_Variable_Values, External_Control_of_File_Name_or_Path,Medium).
weaknesses(Subverting_Environment_Variable_Values, Improper_Input_Validation,Medium).
weaknesses(Subverting_Environment_Variable_Values, Exposure_of_Sensitive_Information_to_an_Unauthorized_Actor,Medium).

weaknesses(Manipulating_Hidden_Fields, Client-Side_Enforcement_of_Server-Side_Security,High).

weaknesses(Create_Malicious_Client, Client-Side_Enforcement_of_Server-Side_Security,Medium).

weaknesses(Removing_Important_Client_Functionality, Client-Side_Enforcement_of_Server-Side_Security,Low).

weaknesses(Removing/short-circuiting_'Purse'_logic:_removing/mutating_'cash'_decrements, Client-Side_Enforcement_of_Server-Side_Security,VeryHigh).

weaknesses(XML_Routing_Detour_Attacks, Unintended_Proxy_or_Intermediary_('Confused_Deputy'),Medium).
weaknesses(XML_Routing_Detour_Attacks, Externally_Controlled_Reference_to_a_Resource_in_Another_Sphere,Medium).

weaknesses(Application_API_Message_Manipulation_via_Man-in-the-Middle, Modification_of_Assumed-Immutable_Data_(MAID), Low).
weaknesses(Application_API_Message_Manipulation_via_Man-in-the-Middle, Insufficient_Verification_of_Data_Authenticity, Low).
weaknesses(Application_API_Message_Manipulation_via_Man-in-the-Middle, Origin_Validation_Error,Low).
weaknesses(Application_API_Message_Manipulation_via_Man-in-the-Middle, Client-Side_Enforcement_of_Server-Side_Security,Low).
weaknesses(Application_API_Message_Manipulation_via_Man-in-the-Middle, Missing_Encryption_of_Sensitive_Data,Low).

weaknesses(Transaction_or_Event_Tampering_via_Application_API_Manipulation, Modification_of_Assumed-Immutable_Data_(MAID),High).
weaknesses(Transaction_or_Event_Tampering_via_Application_API_Manipulation, Insufficient_Verification_of_Data_Authenticity,High).
weaknesses(Transaction_or_Event_Tampering_via_Application_API_Manipulation, Origin_Validation_Error,High).
weaknesses(Transaction_or_Event_Tampering_via_Application_API_Manipulation, Client-Side_Enforcement_of_Server-Side_Security,High).
weaknesses(Transaction_or_Event_Tampering_via_Application_API_Manipulation, Missing_Encryption_of_Sensitive_Data,High).

weaknesses(Content_Spoofing_Via_Application_API_Manipulation, Missing_Support_for_Integrity_Check, Medium).

weaknesses(Application_API_Navigation_Remapping, Modification of Assumed-Immutable Data (MAID), Low).
weaknesses(Application_API_Navigation_Remapping, Insufficient Verification of Data Authenticity, Low).
weaknesses(Application_API_Navigation_Remapping, Origin Validation Error, Low).
weaknesses(Application_API_Navigation_Remapping, Client-Side Enforcement of Server-Side Security, Low).
weaknesses(Application_API_Navigation_Remapping, Missing Encryption of Sensitive Data, Low).

weaknesses(Navigation_Remapping_To_Propagate_Malicious_Content, Modification of Assumed-Immutable Data (MAID), Medium).
weaknesses(Navigation_Remapping_To_Propagate_Malicious_Content, Insufficient Verification of Data Authenticity, Medium).
weaknesses(Navigation_Remapping_To_Propagate_Malicious_Content, Origin Validation Error, Medium).
weaknesses(Navigation_Remapping_To_Propagate_Malicious_Content, Client-Side Enforcement of Server-Side Security, Medium).
weaknesses(Navigation_Remapping_To_Propagate_Malicious_Content, Missing Encryption of Sensitive Data, Medium).



weaknesses(Application_API_Button_Hijacking, Modification of Assumed-Immutable Data (MAID), Low).
weaknesses(Application_API_Button_Hijacking, Insufficient Verification of Data Authenticity, Low).
weaknesses(Application_API_Button_Hijacking, Origin Validation Error, Low).
weaknesses(Application_API_Button_Hijacking, Client-Side Enforcement of Server-Side Security, Low).
weaknesses(Application_API_Button_Hijacking, Missing Encryption of Sensitive Data,Low).

weaknesses(Leveraging_Active_Man_in_the_Middle_Attacks_to_Bypass_Same_Origin_Policy, Channel_Accessible_by_Non-Endpoint,VeryHigh).

weaknesses(Reflection_Attack_in_Authentication_Protocol, Reflection_Attack_in_an_Authentication_Protocol, Low).
weaknesses(Reflection_Attack_in_Authentication_Protocol, Incorrect_Implementation_of_Authentication_Algorithm, Low).
weaknesses(Reflection_Attack_in_Authentication_Protocol, OWASP_Top_Ten_2007_Category_A7_-_Broken_Authentication_and_Session_Management, Low).


weaknesses(Forceful_Browsing, Direct_Request,Medium).
weaknesses(Forceful_Browsing, Improper_Authorization,Medium).
weaknesses(Forceful_Browsing, Protection_Mechanism_Failure,Medium).

weaknesses(Web_Services_API_Signature_Forgery_Leveraging_Hash_Function_Extension_Weakness, Reversible_One-Way_Hash,Medium).
weaknesses(Web_Services_API_Signature_Forgery_Leveraging_Hash_Function_Extension_Weakness, Authentication_Bypass_by_Spoofing, Medium).

weaknesses(Escaping_Virtualization, Protection_Mechanism_Failure,High).


weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Incorrect_Default_Permissions,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Improper_Authorization,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Unrestricted_Upload_of_File_with_Dangerous_Type,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Protection_Mechanism_Failure,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,OWASP_Top_Ten_2007_Category_A10 - Failure_to_Restrict_URL_Access,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Incorrect_Permission_Assignment_for_Critical_Resource,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Exposed_Chip_Debug_and_Test_Interface_With_Insufficient_or_Missing_Authorization,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Power-On_of_Untrusted_Execution_Core_Before_Enabling_Fabric_Access_Control,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Insufficient_Granularity_of_Access_Control,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Improper_Restriction_of_Write-Once_Bit_Fields,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,	Improper_Access_to_Sensitive_Information_Using_Debug_and_Test_Interfaces,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,CPU_Hardware_Not_Configured_to_Support_Exclusivity_of_Write_and_Execute_Operations,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Improper_Access_Control_Applied_to_Mirrored_or_Aliased_Memory_Regions,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,	Register_Interface_Allows_Software_Access_to_Sensitive_Data_or_Security_Settings,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Policy_Privileges_are_not_Assigned_Consistently_Between_Control_and_Data_Agents,High.
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Mutable_Attestation_or_Measurement_Reporting_Data,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Improper_Translation_of_Security_Attributes_by_Fabric_Bridge,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Missing_Protection_for_Mirrored_Regions_in_On-Chip_Fabric_Firewall,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Hardware_Allows_Activation_of_Test_or_Debug_Logic_at_Runtime,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Missing_Write_Protection_for_Parametric_Data_Values,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Improper_Setting_of_Bus_Controlling_Capability_in_Fabric_End-point).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Missing_Support_for_Security_Features_in_On-chip_Fabrics_or_
Buses,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,	Improper_Protection_for_Out_of_Bounds_Signal_Level_Alerts,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Improperly_Controlled_Modification_of_Object_Prototype_Attributes).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Missing_Immutable_Root_of_Trust_in_Hardware,High).
weaknesses(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,Binding_to_an_Unrestricted_IP_Address, High).


weaknesses(Restful_Privilege_Elevation,Privilege_Defined_With_Unsafe_Actions, Medium).
weaknesses(Restful_Privilege_Elevation,Improper_Privilege_Management, Medium).
weaknesses(Restful_Privilege_Elevation,Permissions, Privileges, and
_Access_Controls, Medium).


weaknesses(Using_Malicious_Files,Incorrect_Permission_Assignment_for_Critical_Resource,High).
weaknesses(Using_Malicious_Files,Improper_Authorization,High).
weaknesses(Using_Malicious_Files,Least_Privilege_Violation,High).
weaknesses(Using_Malicious_Files,Improper_Link_Resolution_Before_File_Access,High ).
weaknesses(Using_Malicious_Files,Improper_Ownership_Management,High).
weaknesses(Using_Malicious_Files,Permission_Issues,High).
weaknesses(Using_Malicious_Files,Permissions, Privileges, and Access Controls,High).
weaknesses(Using_Malicious_Files,Privilege_Context_Switching_Error,High).
weaknesses(Using_Malicious_Files,Protection_Mechanism_Failure, High).

weaknesses(Create_files_with_the_same_name_as_files_protected_with_a_higher_classification,Use_of_Incorrectly-Resolved_Name_or_Referencee, VeryHigh).

weaknesses(Force_Use_of_Corrupted_Files,Inclusion_of_Functionality_from_Untrusted_Control_Sphere, Medium).

weaknesses(Modify_Shared_File,Improper_Access_Control,High).

weaknesses(Add_Malicious_File_to_Shared_Webroot,Improper_Access_Control, Low).

weaknesses(Replace_Binaries,Incorrect_Permission_Assignment_for_Critical_Resource, Low).

weaknesses(Upload_a_Web_Shell_to_a_Web_Server,Improper_Authentication, Medium).
weaknesses(Upload_a_Web_Shell_to_a_Web_Server,	Command_Shell_in_Externally_Accessible_Directory, Medium).

weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,	Incorrect_Permission_Assignment_for_Critical_Resource, High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,DMA Device_Enabled_Too_Early_in_Boot_Phase, High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Exposed_Chip_Debug_and_Test_Interface_With_Insufficient_or_Missing_Authorization, High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Power_On_of_Untrusted_Execution_Core_Before_Enabling_Fabric_Access_Control, High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Insufficient_Granularity_of_Access_Control, High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Insufficient_Granularity_of_Address_Regions, High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Improper_Restriction_of_Write-Once_Bit_Fields,High).
vweaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Improper_Implementation_of_Lock_Protection_Registers,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Improper_Hardware_Lock_Protection_for_Security_Sensitive_Controls,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Hardware_Internal_or_Debug_Modes_Allow_Override_of_Locks,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Improper_Access_to_Sensitive_Information_Using_Debug_and_Test_Interfaces,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,CPU Hardware_Not_Configured_to_Support_Exclusivity_of_Write_and_Execute_Operations,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Improper_Access_Control_Applied_to_Mirrored_or_Aliased_Memory_Regions,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels, Improper_Restriction_of_Security_Token_Assignment,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,	Improper Handling_of_Overlap_Between_Protected_Memory_Ranges,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Register_Interface_Allows_Software_Access_to_Sensitive_Data_or_Security_Settings,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,	Insufficient_Protections_on_the_Volatile_Memory_Containing_Boot_Code,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Access_Control_Check_Implemented_After_Asset_is_Accessed,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,	Improper_Translation_of_Security_Attributes_by_Fabric_Bridge,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Hardware_Allows_Activation_of_Test_or_Debug_Logic_at_Runtime,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Improper_Setting_of_Bus_Controlling_Capability_in_Fabric_End-point,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,	Missing_Support_for_Security_Features_in_On-chip_Fabricsor_Buses,High).
weaknesses(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Missing_Immutable_Root_of_Trust_in_Hardware,High).

weaknesses(Restful_Privilege_Elevation,	Privilege_Defined_With_Unsafe_Actions, High).
weaknesses(Restful_Privilege_Elevation,Improper_Privilege_Management, High).
weaknesses(Restful_Privilege_Elevation,Permissions, Privileges,and_Access_Controls, High).
weaknesses(Data_Serialization_External_Entities_Blowup,Improper_Restriction_of_XML_External_Entity_Reference, High).

weaknesses(WebView_Exposure,Improper_Access_Control, Low).



weaknesses(Hijacking_a_Privileged_Thread_of_Execution,Privilege_Context_Switching_Error, Low).

weaknesses(Subvert_Code-signing_Facilities,Missing_Cryptographic_Step, Medium).
weaknesses(Subvert_Code-signing_Facilities,Reversible_One-Way_Hash, Medium).
weaknesses(Subvert_Code-signing_Facilities,Missing_Immutable_Root_of_Trust_in_Hardware, Medium).

weaknesses(Target_Programs_with_Elevated_Privileges,Execution_with_Unnecessary_Privileges, High).
weaknesses(Target_Programs_with_Elevated_Privileges,Permissions,_Privileges,_and_Access_Controls, High).
weaknesses(Target_Programs_with_Elevated_Privileges,External_Control_of_System_or_Configuration_Setting, High).

weaknesses(Cross_Zone_Scripting,Execution_with_Unnecessary_Privileges,Medium).
weaknesses(Cross_Zone_Scripting,Not_Using_Complete_Mediation,Medium).
weaknesses(Cross_Zone_Scripting,Improper_Authorization,Medium).
weaknesses(Cross_Zone_Scripting,Improper_Encoding_or_Escaping_of_Output,Medium).
weaknesses(Cross_Zone_Scripting,Improper_Input_Validation, Medium).


weaknesses(Hijacking_a_privileged_process,Incorrect_Permission_Assignment_for_Critical_Resource, Low).
weaknesses(Hijacking_a_privileged_process,Incorrect_Use_of_Privileged_APIs, Low).


weaknesses(Remote_Services_with_Stolen_Credentials, Insufficiently_Protected_Credentials, VeryHigh).
weaknesses(Remote_Services_with_Stolen_Credentials, Use_of_Single-factor_Authentication, VeryHigh).
weaknesses(Remote_Services_with_Stolen_Credentials, Use_of_Password_System_for_Primary_Authentication, VeryHigh).
weaknesses(Remote_Services_with_Stolen_Credentials, Authentication_Bypass_by_Capture-replay, VeryHigh).
weaknesses(Remote_Services_with_Stolen_Credentials, Password_Aging_with_Long_Expiration, VeryHigh).
weaknesses(Remote_Services_with_Stolen_Credentials, Not_Using_Password_Aging, VeryHigh).
weaknesses(Remote_Services_with_Stolen_Credentials, Weak_Password_Requirements, VeryHigh).


weaknesses(Credential_Stuffing, Insufficiently_Protected_Credentials, High).
weaknesses(Credential_Stuffing, Improper_Restriction_of_Excessive_Authentication_Attempts, High).
weaknesses(Credential_Stuffing, Use_of_Single-factor_Authentication, High).
weaknesses(Credential_Stuffing, Use_of_Password_System_for_Primary_Authentication, High).
weaknesses(Credential_Stuffing, Not_Using_Password_Aging, High).
weaknesses(Credential_Stuffing, Password_Aging_with_Long_Expiration, High).
weaknesses(Credential_Stuffing, Reliance_on_a_Single_Factor_in_a_Security_Decision, High).


weaknesses(Use_of_Known_Kerberos_Credentials, Insufficiently_Protected_Credentials, Medium).
weaknesses(Use_of_Known_Kerberos_Credentials, Improper_Restriction_of_Excessive_Authentication_Attempts,Medium).
weaknesses(Use_of_Known_Kerberos_Credentials, Use_of_Single-factor_Authentication, Medium).
weaknesses(Use_of_Known_Kerberos_Credentials, Use_of_Password_System_for_Primary_Authentication, Medium).
weaknesses(Use_of_Known_Kerberos_Credentials, Not_Using_Password_Aging, Medium).
weaknesses(Use_of_Known_Kerberos_Credentials, Password_Aging_with_Long_Expiration, Medium).
weaknesses(Use_of_Known_Kerberos_Credentials, Reliance_on_a_Single_Factor_in_a_Security_Decision, Medium).
weaknesses(Use_of_Known_Kerberos_Credentials, Authentication_Bypass_by_Capture-replay, Medium).
weaknesses(Use_of_Known_Kerberos_Credentials,Use_of_Password_Hash_Instead_of_Password_for_Authentication, Medium).


weaknesses(Kerberoasting, Insufficiently_Protected_Credentials, High).
weaknesses(Kerberoasting, Use_of_Single-factor_Authentication, High).
weaknesses(Kerberoasting, Use_of_Password_System_for_Primary_Authentication, High).
weaknesses(Kerberoasting, Weak_Password_Requirements, High).
weaknesses(Kerberoasting, Not_Using_Password_Aging, High).
weaknesses(Kerberoasting, Password_Aging_with_Long_Expiration, High).
weaknesses(Kerberoasting, Authentication_Bypass_by_Capture-replay, High).

weaknesses(Use_of_Captured_Tickets, Insufficiently_Protected_Credentials, Low).
weaknesses(Use_of_Captured_Tickets, Use_of_Single-factor_Authentication, Low).
weaknesses(Use_of_Captured_Tickets, Authentication_Bypass_by_Capture-replay, Low).


weaknesses(Use_of_Known_Windows_Credentials, Insufficiently_Protected_Credentials, High).
weaknesses(Use_of_Known_Windows_Credentials, Improper_Restriction_of_Excessive_Authentication_Attempts, High).
weaknesses(Use_of_Known_Windows_Credentials, Use_of_Single-factor_Authentication, High).
weaknesses(Use_of_Known_Windows_Credentials, Use_of_Password_System_for_Primary_Authentication, High).
weaknesses(Use_of_Known_Windows_Credentials, Not_Using_Password_Aging, High).
weaknesses(Use_of_Known_Windows_Credentials, Password_Aging_with_Long_Expiration, High).
weaknesses(Use_of_Known_Windows_Credentials, Reliance_on_a_Single_Factor_in_a_Security_Decision, High).


weaknesses(Windows_Admin_Shares_with_Stolen_Credentials, Insufficiently_Protected_Credentials,Low).
weaknesses(Windows_Admin_Shares_with_Stolen_Credentials, Use_of_Single-factor_Authentication,Low).
weaknesses(Windows_Admin_Shares_with_Stolen_Credentials, Use_of_Password_System_for_Primary_Authentication,Low).
weaknesses(Windows_Admin_Shares_with_Stolen_Credentials, Authentication_Bypass_by_Capture-replay,Low).
weaknesses(Windows_Admin_Shares_with_Stolen_Credentials, Password_Aging_with_Long_Expiration,Low).
weaknesses(Windows_Admin_Shares_with_Stolen_Credentials, Not_Using_Password_Aging,Low).
weaknesses(Windows_Admin_Shares_with_Stolen_Credentials, Weak_Password_Requirements, Low).



weaknesses(Use_of_Captured_Hashes, Insufficiently_Protected_Credentials, Medium).
weaknesses(Use_of_Captured_Hashes, Use_of_Password_Hash_Instead_of_Password_for_Authentication, Medium).
weaknesses(Use_of_Captured_Hashes,  Use_of_Single-factor_Authentication, Medium).
weaknesses(Use_of_Captured_Hashes, Authentication_Bypass_by_Capture-replay, Medium).


%*******************************************************************************************************
%*******************************PREDUSLOVI

prerequisites(Exploitation_of_Trusted_Identifiers, Server_software_must_rely_on_weak_identifier_proof_and/or_verification_schemes).
prerequisites(Exploitation_of_Trusted_Identifiers, Identifiers_must_have_long_lifetimes_and_potential_for_reusability).
prerequisites(Exploitation_of_Trusted_Identifiers, Server_software_must_allow_concurrent_sessions_to_exist).
prerequisites(Exploiting_Trust_in_Client, Server_software_must_rely_on_client_side_formatted_and_validated_values,and_not_reinforce_these_checks_on_the_server_side).

prerequisites(Man_in_the_Middle_Attack, There_are_two_components_communicating_with_each_other).
prerequisites(Man_in_the_Middle_Attack, An_attacker_is_able_to_identify_the_nature_and_mechanism_of_communication_between_the_two_target_components).
prerequisites(Man_in_the_Middle_Attack, An_attacker_can_eavesdrop_on_the_communication_between_the_target_components).
prerequisites(Man_in_the_Middle_Attack, Strong_mutual_authentication_is_not_used_between_the_two_target_components_yielding_opportunity_for_attacker_interposition).
prerequisites(Man_in_the_Middle_Attack, The_communication_occurs_in_clear_(not encrypted)_or_with_insufficient_and_spoofable_encryption).

prerequisites(Authentication_Abuse, An_authentication_mechanism_or_subsystem_implementing_some_form_of_authentication_such_as_passwords,digest_authentication,_security_certificates,etc.which_is_flawed_in_some_way).

prerequisites(Authentication_Bypass, An_authentication_mechanism_or_subsystem_implementing_some_form_of_authentication_such_as_passwords,digest_authentication,security_certificates).

prerequisites(Privilege_Abuse, The_target_must_have_misconfigured_their_access_control_mechanisms_such_that_sensitive_information,which_should_only_be_accessible_to_more_trusted_users,remains_accessible_to_less_trusted_users).
prerequisites(Privilege_Abuse, The_adversary_must_have_access_to_the_target,albeit_with_an_account_that_is_less_privileged_than_would_be_appropriate_for_the_targeted_resources).

prerequisites(Physical_Theft, Requires_the_existence_of_a_physical_target_that_an_adversary_believes_hosts_something_of_value).

prerequisites(Use_of_Known_Domain_Credentials, The_system/application_uses_one_factor_password_based_authentication,SSO,and/or_cloud-based_authentication).
prerequisites(Use_of_Known_Domain_Credentials, The_system/application_does_not_have_a_sound_password_policy_that_is_being_enforced).
prerequisites(Use_of_Known_Domain_Credentials, The_system/application_does_not_implement_an_effective_password_throttling_mechanism).
prerequisites(Use_of_Known_Domain_Credentials, The_adversary_possesses_a_list_of_known_user_accounts_and_corresponding_passwords_that_may_exist_on_the_target).

prerequisites(Cross_Site_Identification, The_victim_has_an_active_session_with_the_social_networking_site).

prerequisites(Session_Credential_Falsification_through_Forging, The_targeted_application_must_use_session_credentials_to_identify_legitimate_users).

prerequisites(Session_Credential_Falsification_through_Prediction, The_target_host_uses_session_IDs_to_keep_track_of_the_users).
prerequisites(Session_Credential_Falsification_through_Prediction, Session_IDs_are_used_to_control_access_to_resources).
prerequisites(Session_Credential_Falsification_through_Prediction, The_session_IDs_used_by_the_target_host_are_predictable).

prerequisites(Session_Credential_Falsification_through_Manipulation, The_targeted_application_must_use_session_credentials_to_identify_legitimate_users).

prerequisites(SaaS_User_Request_Forgery, An_adversary_must_be_able_install_a_purpose_built_malicious_application_onto_the_trusted_user's_system_and_convince_the_user_to_execute_it_while_authenticated_to_the_SaaS_application).

prerequisites(Session_Hijacking, An_application_that_leverages_sessions_to_perform_authentication).

prerequisites(Reusing_Session_IDs(aka_Session_Replay), The_target_host_uses_session_IDs_to_keep_track_of_the_users).
prerequisites(Reusing_Session_IDs(aka_Session_Replay), Session_IDs_are_used_to_control_access_to_resources).
prerequisites(Reusing_Session_IDs(aka_Session_Replay), The_session_IDs_used_by_the_target_host_are_not_well_protected_from_session_theft).

prerequisites(Session_Fixation, Session_identifiers_that_remain_unchanged_when_the_privilege_levels_change).
prerequisites(Session_Fixation, Permissive_session_management_mechanism_that_accepts_random_user-generated_session_identifiers).
prerequisites(Session_Fixation, Predictable_session_identifiers).

prerequisites(Session_Sidejacking, An_attacker_and_the_victim_are_both_using_the_same_WiFi_network).
prerequisites(Session_Sidejacking, The_victim_has_an_active_session_with_a_target_system).
prerequisites(Session_Sidejacking, The_victim_is_not_using_a_secure_channel_to_communicate_with_the_target_system(e.g._SSL,VPN..)).
prerequisites(Session_Sidejacking, The_victim_initiated_communication_with_a_target_system_that_requires_transfer_of_the_session_token_or_the_target_application_uses_AJAX_and_thereby_periodically_"rings home"_asynchronously_using_the_session_token).

prerequisites(Cross_Site_Tracing, HTTP_TRACE_is_enabled_on_the_web_server).
prerequisites(Cross_Site_Tracing, The_destination_system_is_susceptible_to_XSS_or_an_adversary_can_leverage_some_other_weakness_to_bypass_the_same_origin_policy).
prerequisites(Cross_Site_Tracing, Scripting_is_enabled_in_the_client's_browser).
prerequisites(Cross_Site_Tracing, HTTP_is_used_as_the_communication_protocol_between_the_server_and_the_client).

prerequisites(Manipulating_Opaque_Client-based_Data_Tokens, An_attacker_already_has_some_access_to_the_system_or_can_steal_the_client_based_data_tokens_from_another_user_who_has_access_to_the_system).
prerequisites(Manipulating_Opaque_Client-based_Data_Tokens, Some_data_must_be_held_client-side_in_a_way_that_can_be_manipulated_without_detection).


prerequisites(Accessing/Intercepting/Modifying_HTTP_Cookies, Target_server_software_must_be_a_HTTP_daemon_that_relies_on_cookies).
prerequisites(Accessing/Intercepting/Modifying_HTTP_Cookies, The_cookies_must_contain_sensitive_information).
prerequisites(Accessing/Intercepting/Modifying_HTTP_Cookies, The_adversary_must_be_able_to_make_HTTP_requests_to_the_server,_and_the_cookie_must_be_contained_in_the_reply).

prerequisites(Manipulating_User-Controlled_Variables, A_variable_consumed_by_the_application_server_is_exposed_to_the_client).
prerequisites(Manipulating_User-Controlled_Variables, A_variable_consumed_by_the_application_server_can_be_overwritten_by_the_user).
prerequisites(Manipulating_User-Controlled_Variables, The_application_server_trusts_user_supplied_data_to_compute_business_logic ).
prerequisites(Manipulating_User-Controlled_Variables, The_application_server_does_not_perform_proper_input_validation).

prerequisites(Subverting_Environment_Variable_Values, An_environment_variable_is_accessible_to_the_user).
prerequisites(Subverting_Environment_Variable_Values, An_environment_variable_used_by_the_application_can_be_tainted_with_user_supplied_data).
prerequisites(Subverting_Environment_Variable_Values, Input_data_used_in_an_environment_variable_is_not_validated_properly).
prerequisites(Subverting_Environment_Variable_Values, The_variables_encapsulation_is_not_done_properly).

prerequisites(Manipulating_Hidden_Fields, The_targeted_site_must_contain_hidden_fields_to_be_modified).
prerequisites(Manipulating_Hidden_Fields, The_targeted_site_must_not_validate_the_hidden_fields_with_backend_processing).

prerequisites(Create_Malicious_Client, The_targeted_service_must_make_assumptions_about_the_behavior_of_the_client_application_that_interacts_with_it,_which_can_be_abused_by_an_adversary).

prerequisites(Removing_Important_Client_Functionality, The_targeted_server_must_assume_the_client_performs_important_actions_to_protect_the_server_or_the_server_functionality).

prerequisites(Removal_of_filters:_Input_filters,_output_filters,_data_masking, The_target_application_must_utilize_some_sort_of_filtering_mechanism_(input,_output,_or_data_masking)).


prerequisites(Removing/short-circuiting_'Purse'_logic:_removing/mutating_'cash'_decrements,_data_masking, The_targeted_server_must_rely_on_the_client_to_correctly_perform_monetary_calculations_and_must_fail_to_detect_errors_in_these_calculations).

prerequisites(XML_Routing_Detour_Attacks, The_targeted_system_must_have_multiple_stages_processing_of_XML_content).

prerequisites(Application_API_Message_Manipulation_via_Man-in-the-Middle, Targeted_software_is_utilizing_application_framework_APIs).

prerequisites(Transaction_or_Event_Tampering_via_Application_API_Manipulation, Targeted_software_is_utilizing_application_framework_APIs).

prerequisites(Content_Spoofing_Via_Application_API_Manipulation,Targeted_software_is_utilizing_application_framework_APIs).

prerequisites(Application_API_Navigation_Remapping, Targeted_software_is_utilizing_application_framework_APIs).

prerequisites(Navigation_Remapping_To_Propagate_Malicious_Content, Targeted_software_is_utilizing_application_framework_APIs).

prerequisites(Application_API_Button_Hijacking, Targeted_software_is_utilizing_application_framework_APIs).

prerequisites(Leveraging_Active_Man_in_the_Middle_Attacks_to_Bypass_Same_Origin_Policy, The_victim_and_the_attacker_are_both_in_an_environment_where_an_active_man_in_the_middle_attack_is_possible._The_victim_visits_at_least_one_website_that_does_not_use_TLS_/_SSL).

prerequisites(Reflection_Attack_in_Authentication_Protocol, The_attacker_must_have_direct_access_to_the_target_server_in_order_to_successfully_mount_a_reflection_attack).


prerequisites(Forceful_Browsing,The_forcibly_browseable_pages_or_accessible_resources_must_be_discoverable_and_improperly_protected).


prerequisites(Web_Services_API_Signature_Forgery_Leveraging_Hash_Function_Extension_Weakness,Web_services_check_the_signature_of_the_API_calls).
prerequisites(Web_Services_API_Signature_Forgery_Leveraging_Hash_Function_Extension_Weakness, Authentication_tokens / secrets_are_shared_between_the_server_and_the_legitimate_client).
prerequisites(Web_Services_API_Signature_Forgery_Leveraging_Hash_Function_Extension_Weakness, An_iterative_hash_function_like_MD5_and_SHA1_is_used).


prerequisites(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs, The_application_must_be_navigable_in_a_manner_that_associates_elements_(subsections)_of_the_application_with_ACLs).
prerequisites(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs, The_various_resources, or_individual_URLs,must_be_somehow
_discoverable_by_the_attacker).

prerequisites(Restful_Privilege_Elevation, The_attacker_needs_to_be_able_to_identify_HTTP_Get_URLs).
prerequisites(Using_Malicious_Files, System's_configuration_must_allow_an_attacker_to_directly_access_executable_files_or_upload_files_to_execute).


prerequisites(Create_files_with_the_same_name_as_files_protected_with_a_higher_classification, The_target_application_must_include_external_files, most_non-trivial_applications_meet_this_criterion).

prerequisites(Force_Use_of_Corrupted_Files, The_targeted_application_must_utilize_a_configuration_file_that_an_attacker_is_able_to_corrupt).


prerequisites(Replace_Binaries, The_attacker_must_be_able_to_place_the_malicious_binary_on_the_target_machine).

prerequisites(Upload_a_Web_Shell_to_a_Web_Server, Make_sure_your_web_server_is_up-to-date_with_all_patches_to_protect_against_know_vulnerabilities).

prerequisites(Restful_Privilege_Elevation, The_attacker_needs_to_ be_able_to_identify_HTTP_Get_URLs).

prerequisites(Data_Serialization_External_Entities_Blowup, The_attacker_needs_to_ A_server_that_has_an_implementation_that_accepts_entities_containing_URI_values).

prerequisites(WebView_Exposure, This_type_of_an_attack_requires_the_adversary_to_convince_the_user_to_load_the_malicious_web_page_inside_the_target_application).


prerequisites(Hijacking_a_Privileged_Thread_of_Execution, The_application_in_question_employs_a_threaded_model_of_execution_with_the_threads_operating_at,_or_having_the_ability_to_switch_to,_a_higher_privilege_level_than_normal_users).

prerequisites(Subvert_Code-signing_Facilities,A_framework-based_language_that_supports_code_signing_(such_as,_and_most_commonly,_Java_or_.NET)).
prerequisites(Subvert_Code-signing_Facilities,Deployed_code_that_has_been_signed_by_its_authoring_vendor,_or_a_partner).


prerequisites(Target_Programs_with_Elevated_Privileges,The_targeted_program_runs_with_elevated_OS_privileges).
prerequisites(Target_Programs_with_Elevated_Privileges,The_targeted_program_accepts_input_data_from_the_user_or_from_another_program).
prerequisites(Target_Programs_with_Elevated_Privileges,The_targeted_program_does_not_perform_input_validation_properly).

prerequisites(Cross_Zone_Scripting,The_target_must_be_using_a_zone-aware_browser).

prerequisites(Hijacking_a_privileged_process
,The_targeted_process_or_operating_system_must_contain_a_bug_that_allows_attackers_to_hijack_the_targeted_process).

prerequisites(Magnetic_Strip_Card_Brute_Force_Attacks,The_ability_to_calculate_a_card_checksum_and_write_out_a_valid_checksum_value).

prerequisites(Magnetic_Strip_Card_Brute_Force_Attacks,The_attacker_must_have_physical_access_to_the_device).


prerequisites(Credential_Stuffing,The_system/application_uses_one_factor_password_based_authentication,_SSO,_and/or_cloud-based_authentication).
prerequisites(Credential_Stuffing,The_system/application_does_not_have_a_sound_password_policy_that_is_being_enforced).
prerequisites(Credential_Stuffing,The_system/application_does_not_implement_an_effective_password_throttling_mechanism).
prerequisites(Credential_Stuffing,The_adversary_possesses_a_list_of_known_user_accounts_and_corresponding_passwords_that_may_exist_on_the_target).

prerequisites(Use_of_Known_Kerberos_Credentials,The_system/application_is_connected_to_the_Windows_domain_and_leverages_Kerberos_authentication).
prerequisites(Use_of_Known_Kerberos_Credentials,The_system/application_uses_one_factor_password-based_authentication,_SSO,_and/or_cloud-based_authentication_for_Kerberos_service_accounts).
prerequisites(Use_of_Known_Kerberos_Credentials,The_system/application_does_not_have_a_sound_password_policy_that_is_being_enforced_for_Kerberos_service_accounts).
prerequisites(Use_of_Known_Kerberos_Credentials,The_system/application_does_not_implement_an_effective_password_throttling_mechanism_for_authenticating_to_Kerberos_service_accounts).
prerequisites(Use_of_Known_Kerberos_Credentials,The_targeted_network_allows_for_network_sniffing_attacks_to_succeed).



prerequisites(Kerberoasting,The_adversary_requires_access_as_an_authenticated_user_on_the_system).
prerequisites(Kerberoasting,Attack_pattern_relates_to_elevating_privileges).
prerequisites(Kerberoasting,The_adversary_requires_use_of_a_third-party_credential_harvesting_tool).
prerequisites(Kerberoasting,The_adversary_requires_a_brute_force_tool).

prerequisites(Use_of_Captured_Tickets, The_adversary_needs_physical_access_to_the_victim_system).
prerequisites(Use_of_Captured_Tickets, The_use_of_a_third-party_credential_harvesting_tool).


prerequisites(Use_of_Known_Windows_Credentials, The_system/application_is_connected_to_the_Windows_domain).
prerequisites(Use_of_Known_Windows_Credentials, The_system/application_uses_one_factor_password-based_authentication,_SSO,_and/or_cloud-based_authentication).
prerequisites(Use_of_Known_Windows_Credentials, The_system/application_does_not_have_a_sound_password_policy_that_is_being_enforced).
prerequisites(Use_of_Known_Windows_Credentials, The_system/application_does_not_implement_an_effective_password_throttling_mechanism).
prerequisites(Use_of_Known_Windows_Credentials, The_adversary_possesses_a_list_of_known_Windows_user_accounts_and_corresponding_passwords_that_may_exist_on_the_target).


prerequisites(Windows_Admin_Shares_with_Stolen_Credentials, The_system/application_is_connected_to_the_Windows_domain).
prerequisites(Windows_Admin_Shares_with_Stolen_Credentials, The_target_administrative_share_allows_remote_use_of_local_admin_credentials_to_log_into_domain_systems).
prerequisites(Windows_Admin_Shares_with_Stolen_Credentials,The_adversary_possesses_a_list_of_known_Windows_administrator_credentials_that_exist_on_the_target_domain).


prerequisites(Use_of_Captured_Hashes, The_system/application_is_connected_to_the_Windows_domain).
prerequisites(Use_of_Captured_Hashes, The_system/application_leverages_the_Lan_Man_(LM)_and/or_NT_Lan_Man_(NTLM)_authentication_protocols).
prerequisites(Use_of_Captured_Hashes,The_adversary_possesses_known_Windows_credential_hash_value_pairs_that_exist_on_the_target_domain).

%**********************************************************************************************
%**********************TOK IZVRSAVANJA

execution_flow(Exploitation_of_Trusted_Identifiers, Explore, Survey_the_application_for_Indicators_of_Susceptibility).
execution_flow(Exploitation_of_Trusted_Identifiers, Experiment, Fetch_samples).
execution_flow(Exploitation_of_Trusted_Identifiers, Exploit, [Impersonate, Spoofing, Data_Exfiltration]).

execution_flow(Use_of_Known_Domain_Credentials, Explore, [Acquire_known_credentials, Determine_target's_password_policy]).
execution_flow(Use_of_Known_Domain_Credentials, Experiment, Attempt_authentication).
execution_flow(Use_of_Known_Domain_Credentials, Exploit, [Impersonate, Spoofing, Data_Exfiltration]).

execution_flow(Man_in_the_Middle_Attack, Experiment, [The_attacker_probes_to_determine_the_nature_and_mechanism_of_communication_between_two_components_looking_for_opportunities_to_exploit, The_attacker_inserts_themself_into_the_communication_channel_initially_acting_as_a_routing_proxy_between_the_two_targeted_components]).
execution_flow(Man_in_the_Middle_Attack, Exploit, The_attacker_observes_passed_data_of_its_choosing_to_gain_access_to_sensitive_information_or_to_manipulate_the_actions_of_the_two_target_components_for_their_own_purposes).

execution_flow(Cross_Site_Request_Forgery, Explore, Explore_target_website).
execution_flow(Cross_Site_Request_Forgery, Experiment, Create_a_link_that_when_clicked_on,will_execute_the_interesting_functionality).
execution_flow(Cross_Site_Request_Forgery, Exploit, [Convince_user_to_click_on_link]).

execution_flow(Session_Credential_Falsification_through_Forging, Explore, Analyze_and_Understand_Session_IDs).
execution_flow(Session_Credential_Falsification_through_Forging, Experiment, Create_Session_IDs).
execution_flow(Session_Credential_Falsification_through_Forging, Exploit, Abuse_the_Victim's_Session_Credentials).

execution_flow(Session_Credential_Falsification_through_Prediction, Explore, [Find_Session_IDs, Characterize_IDs]).
execution_flow(Session_Credential_Falsification_through_Prediction, Experiment, Match_issued_IDs).
execution_flow(Session_Credential_Falsification_through_Prediction, Exploit, Use_matched_Session_ID).

execution_flow(Reusing_Session_IDs(aka_Session_Replay), Explore, [The_attacker_interacts_with_the_target_host_and_finds_that_session_IDs_are_used_to_authenticate_users, The_attacker_steals_a_session_ID_from_a_valid_user]).
execution_flow(Reusing_Session_IDs(aka_Session_Replay), Exploit, The_attacker_tries_to_use_the_stolen_session_ID).

execution_flow(Session_Fixation, Explore, Setup_the_Attack).
execution_flow(Session_Fixation, Experiment, Attract_a_Victim).
execution_flow(Session_Fixation, Exploit, Abuse_the_Victim's_Session).


execution_flow(Session_Sidejacking, Explore, Detect_Unprotected_Session_Token_Transfer).
execution_flow(Session_Sidejacking, Experiment, [Capture_session_token, Insert_captured_session_token]).
execution_flow(Session_Sidejacking, Exploit, Session_Token_Exploitation).


execution_flow(Cross_Site_Tracing, Explore, Determine_if_HTTP_Trace_is_enabled).
execution_flow(Cross_Site_Tracing, Experiment, Identify_mechanism_to_launch_HTTP_Trace_request).
execution_flow(Cross_Site_Tracing, Exploit, [Create_a_malicious_script_that_pings_the_web_server_with_HTTP_TRACE_request, Execute_malicious_HTTP_Trace_launching_script, Intercept_HTTP_TRACE_response]).

execution_flow(Manipulating_Opaque_Client-based_Data_Tokens, Explore, [Enumerate_information_passed_to_client_side,Determine_protection_mechanism_for_opaque_token]).
execution_flow(Manipulating_Opaque_Client-based_Data_Tokens, Experiment, [Modify_parameter/token_values, Cycle_through_values_for_each_parameter]).

execution_flow(Accessing/Intercepting/Modifying_HTTP_Cookies, Explore, Obtain_copy_of_cookie).
execution_flow(Accessing/Intercepting/Modifying_HTTP_Cookies, Experiment, [Obtain_sensitive_information_from_cookie, Modify_cookie_to_subvert_security_controls]).

execution_flow(Manipulating_User-Controlled_Variables, Explore, The_attacker_communicates_with_the_application_server_using_a_thin_client_(browser)_or_thick_client).
execution_flow(Manipulating_User-Controlled_Variables, Experiment, While_communicating_with_the_server,_the_attacker_finds_that_they_can_control_and_override_a_variable_consumed_by_the_application_server).
execution_flow(Manipulating_User-Controlled_Variables, Exploit, The_attacker_overrides_the_variable_and_influences_the_normal_behavior_of_the_application_server).

execution_flow(Subverting_Environment_Variable_Values, Explore, The_attacker_probes_the_application_for_information).
execution_flow(Subverting_Environment_Variable_Values, Experiment, The_attacker_gains_control_of_an_environment_variable_and_ties_to_find_out_what_process(es)_the_environment_variable_controls).
execution_flow(Subverting_Environment_Variable_Values, Exploit, The_attacker_modifies_the_environment_variable_to_abuse_the_normal_flow_of_processes_or_to_gain_access_to_privileged_resources).

execution_flow(Removing_Important_Client_Functionality, Explore, Probing).
execution_flow(Removing_Important_Client_Functionality, Experiment, Determine_which_functionality_to_disable_or_remove).
execution_flow(Removing_Important_Client_Functionality, Exploit, Disable_or_remove_the_critical_functionality_from_the_client_code).

execution_flow(XML_Routing_Detour_Attacks, Explore, Survey_the_target).
execution_flow(XML_Routing_Detour_Attacks, Experiment, Identify_SOAP_messages_that_have_multiple_state_processing).
execution_flow(XML_Routing_Detour_Attacks, Exploit, Launch_an_XML_routing_detour_attack).

execution_flow(Reflection_Attack_in_Authentication_Protocol, Experiment, [The_attacker_opens_a_connection_to_the_target_server_and_sends_it_a_challenge, The_server_responds_by_returning_the_challenge_encrypted_with_a_shared_secret_as_well_as_its_own_challenge_to_the_attacker, Since_the_attacker_does_not_possess_the_shared_secret,_they_initiate_a_second_connection_to_the_server_and_sends_it,_as_challenge,_the_challenge_received_from_the_server_on_the_first_connection, The_server_treats_this_as_just_another_handshake_and_responds_by_encrypting_the_challenge_and_issuing_its_own_to_the_attacker,The_attacker_now_receives_the_encrypted_challenge_on_the_second_connection_and_sends_it_as_response_to_the_server_on_the_first_connection,_thereby_successfully_completing_the_handshake_and_authenticating_to_the_server]).


execution_flow(Forceful_Browsing, Explore, Spider).
execution_flow(Forceful_Browsing, Experiment, Attempt_well-known_or_guessable_resource_locations).
execution_flow(Forceful_Browsing, Exploit,[Use_unauthorized_resources, View_unauthorized_data]).

execution_flow(Escaping_a_Sandbox_by_Calling_Code_in_Another_Language, Explore, [Probing,Analysis]).
execution_flow(Escaping_a_Sandbox_by_Calling_Code_in_Another_Language, Experiment, Verify_the_exploitable_security_weaknesses).
execution_flow(Escaping_a_Sandbox_by_Calling_Code_in_Another_Language, Exploit,Exploit_the_security_weaknesses_in_the_standard_libraries).


execution_flow(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs, Explore, [Survey,Identify_Functionality]).
execution_flow(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs, Experiment, Iterate_over_access_capabilities).

execution_flow(Hijacking_a_Privileged_Thread_of_Execution, Explore, Adversary_determines_the_underlying_system_thread_that_is_subject_to_user-control).
execution_flow(Hijacking_a_Privileged_Thread_of_Execution, Experiment, Adversary_then_provides_input, perhaps_by_ way_of_environment_variables_for_the_process_in_question, that-_affect_the_executing_thread).
execution_flow(Hijacking_a_Privileged_Thread_of_Execution, Exploit,Exploit_the_security_weaknesses_in_the_standard_libraries).


execution_flow(Target_Programs_with_Elevated_Privileges
_ACLs, Explore, [The_attacker_probes_for_programs_running_with_elevated_privileges,
The_attacker_finds_a_bug_in_a_program_running_with_elevated_privileges]).
execution_flow(Target_Programs_with_Elevated_Privileges
_ACLs, Exploit, The_attacker_exploits_the_bug_that_they_have_found._For_instance,_they_can_try_to_inject_and_execute_arbitrary_code_or_write_to_OS_resources).


execution_flow(Cross_Zone_Scripting, Explore, Find_systems_susceptible_to_the_attack).
execution_flow(Cross_Zone_Scripting, Experiment, Find_the_insertion_point_for_the_payload).
execution_flow(Cross_Zone_Scripting, Exploit,Craft_and_inject_the_payload).


execution_flow(Credential_Stuffing,Explore,[Acquire_known_credentials,Determine_target's_password_policy]).
execution_flow(Credential_Stuffing,Experiment, Attempt_authentication).
execution_flow(Credential_Stuffing,Exploit,[Impersionate,Spoofing,Data_Exfiltration]).


execution_flow(Use_of_Known_Kerberos_Credentials,Explore,[Acquire_known_Kerberos_credentials,Determine_target's_password_policy]).
execution_flow(Use_of_Known_Kerberos_Credentials,Experiment, Attempt_Kerberos_authentication).
execution_flow(Use_of_Known_Kerberos_Credentials,Exploit,[Impersionate,Spoofing,Data_Exfiltration]).

execution_flow(Kerberoasting,Explore,[Scan_for_user_accounts_with_set_SPN_values
,Request_service_tickets]).
execution_flow(Kerberoasting,Experiment, Extract_ticket_and_save_to_disk).
execution_flow(Kerberoasting,Exploit,Crack_the_encrypted_ticket_to_harvest_plain_text_credentials).

execution_flow(Use_of_Known_Windows_Credentials,Explore,Acquire_known_Windows_credentials).
execution_flow(Use_of_Known_Windows_Credentials,Experiment, Attempt_domain_authentication).
execution_flow(Use_of_Known_Windows_Credentials,Exploit,[Impersionate,Spoofing,Data_Exfiltration]).


execution_flow(Windows_Admin_Shares_with_Stolen_Credentials,Explore,Acquire_known_Windows_administrator _credentials).
execution_flow(Windows_Admin_Shares_with_Stolen_Credentials,Experiment, Attempt_domain_authentication).
execution_flow(Windows_Admin_Shares_with_Stolen_Credentials,Exploit,[Malware_Execution,Data_Exfiltration]).


execution_flow(Use_of_Captured_Hashes,Explore,Acquire_known_Windows_credential_hash_value_pairs).
execution_flow(Use_of_Captured_Hashes,Experiment, Attempt_domain_authentication).
execution_flow(Use_of_Captured_Hashes,Exploit,[Impersionate,Spoofing,Data_Exfiltration]).

%*****************************************************************************************
%***********************MERE UBLAZAVANJA

mitigations(Exploiting_Trust_in_Client, Design,Ensure_that_client_process_and/or_message_is_authenticated_so_that_anonymous_communications_and/or_messages_are_not_accepted_by_the_system).
mitigations(Exploiting_Trust_in_Client, Design, Do_not_rely_on_client_validation_or_encoding_for_security_purposes).
mitigations(Exploiting_Trust_in_Client, Design, Utilize digital signatures to increase authentication assurance).
mitigations(Exploiting_Trust_in_Client, Design, Utilize_two_factor_authentication_to_increase_authentication assurance.).
mitigations(Exploiting_Trust_in_Client, Implementation, Perform_input_validation_for_all_remote_content).

mitigations(Man_in_the_Middle_Attack, _, Get_your_Public_Key_signed_by_a_Certificate_Authority).
mitigations(Man_in_the_Middle_Attack, _, Encrypt_your_communication_using_cryptography(SSL,...)).
mitigations(Man_in_the_Middle_Attack, _, Use_Strong_mutual_authentication_to_always_fully_authenticate_both_ends_of_any_communications_channel).
mitigations(Man_in_the_Middle_Attack, _, Exchange_public_keys_using_a_secure_channel).

mitigations(Privilege_Abuse, _, Configure_account_privileges_such_privileged/administrator_functionality_is_not_exposed_to_non-privileged/lower_accounts).

mitigations(Physical_Theft, _, Physical_security_techniques_such_as_locks_doors,alarms,and_monitoring_of_targets_should_be_implemented).


mitigations(Use_of_Known_Domain_Credentials, _, Leverage_multi-factor_authentication_for_all_authentication_services_and_prior_to_granting_an_entity_access_to_the_domain_network).
mitigations(Use_of_Known_Domain_Credentials, _, Create_a_strong_password_policy_and_ensure_that_your_system_enforces_this_policy).
mitigations(Use_of_Known_Domain_Credentials, _, Ensure_users_are_not_reusing_username/passwor_combinations_for_multiple_systems,applications,or_services).
mitigations(Use_of_Known_Domain_Credentials, _, Do_not_reuse_local_administrator_account_credentials_across_systems).
mitigations(Use_of_Known_Domain_Credentials, _, Deny_remote_use_of_local_admin_credentials_to_log_into_domain_systems).
mitigations(Use_of_Known_Domain_Credentials, _, Do_not_allow_accounts_to_be_a_local_administrator_on_more_than_one_system).
mitigations(Use_of_Known_Domain_Credentials, _, Implement_an_intelligent_password_throttling_mechanism.Care_must_be_taken_to_assure_that_these_mechanisms_do_not_excessively_enable_account_lockout_attacks_such_as-CAPEC-2).
mitigations(Use_of_Known_Domain_Credentials, _, Monitor_system_and_domain_logs_for_abnormal_credential_access).


mitigations(Exploitation_of_Trusted_Identifiers, Design, Utilize_strong_federated_identity_such_as_SAML_to_encrypt_and_sign_identity_tokens_in_transit).
mitigations(Exploitation_of_Trusted_Identifiers, Implementation, Use_industry_standards_session_key_generation_mechanisms_that_utilize_high_amount_of_entropy_to_generate_the_session_key.Many_standard_web_and_application_servers_will_perform_this_task_on_your_behalf).
mitigations(Exploitation_of_Trusted_Identifiers, Implementation, If_the_identifier_is_used_for_authentication,such_as_in_the_so-called_single_sign_on_use_cases,then_ensure_that_it_is_protected_at_the_same_level_of_assurance_as_authentication_tokens).
mitigations(Exploitation_of_Trusted_Identifiers, Implementation, If_the_web_or_application_server_supports_it,then_encrypting_and/or_signing_the_identifier(such_as_cookie)can_protect_the_ID_if_intercepted).
mitigations(Exploitation_of_Trusted_Identifiers, Design, Use_strong_session_identifiers_that_are_protected_in_transit_and_at_rest).
mitigations(Exploitation_of_Trusted_Identifiers, Implementation, Utilize_a_session_timeout_for_all_sessions,for_example_20_minutes.If_the_user_does_not_explicitly_logout,the_server_terminates_their_session_after_this_period_of_inactivity.If_the_user_logs_back_in_then_a_new_session_key_is_generated).
mitigations(Exploitation_of_Trusted_Identifiers, Implementation, Verify_authenticity_of_all_identifiers_at_runtime).


mitigations(Cross_Site_Request_Forgery, _, Use_cryptographic_tokens_to_associate_a_request_with_a_specific_action.The_token_can_be_regenerated_at_every_request_so_that_if_a_request_with_an_invalid_token_is_encountered,it_can_be_reliably_discarded.The_token_is_considered_invalid_if_it_arrived_with_a_request_other_than_the_action_it_was_supposed_to_be_associated_with).
mitigations(Cross_Site_Request_Forgery, _, The_use_of_the_optional_HTTP_Referrer_header_can_also_be_used_to_determine_whether_an_incoming_request_was_actually_one_that_the_user_is_authorized_for, in the current context).
mitigations(Cross_Site_Request_Forgery, _, The_user_can_also_be_prompted_to_confirm_an_action_every_time_an_action_concerning_potentially_sensitive_data_is_invoked).
mitigations(Cross_Site_Request_Forgery, _, Every_request_must_be_checked_for_the_appropriate_authentication_token_as_well_as_authorization_in_the_current_session_context).

mitigations(Cross_Site_Identification, Usage, Users_should_always_explicitly_log_out_from_the_social_networking_sites_when_done_using_them).
mitigations(Cross_Site_Identification, Usage, Users_should_not_open_other_tabs_in_the_browser_when_using_a_social_networking_site).

mitigations(Session_Credential_Falsification_through_Forging, Implementation, Use_session_IDs_that_are_difficult_to_guess_or_brute-force).
mitigations(Session_Credential_Falsification_through_Forging, Implementation, Regenerate_and_destroy_session_identifiers_when_there_is_a_change_in_the_level_of_privilege).

mitigations(Session_Credential_Falsification_through_Prediction, _, Use_a_strong_source_of_randomness_to_generate_a_session_ID).
mitigations(Session_Credential_Falsification_through_Prediction, _, Use_adequate_length_session_IDs).
mitigations(Session_Credential_Falsification_through_Prediction, _, Do_not_use_information_available_to_the_user_in_order_to_generate_session_ID).
mitigations(Session_Credential_Falsification_through_Prediction, _, Ideas_for_creating_random_numbers_are_offered_by_Eastlake[RFC1750]).
mitigations(Session_Credential_Falsification_through_Prediction, _, Encrypt_the_session_ID_if_you_expose_it_to_the_user).

mitigations(SaaS_User_Request_Forgery, _, To_limit_one's_exposure_to_this_type_of_attack,tunnel_communications_through_a_secure_proxy_service).
mitigations(SaaS_User_Request_Forgery, _, Detection_of_this_type_of_attack_can_be_done_through_heuristic_analysis_of_behavioral_anomalies).

mitigations(Session_Hijacking, _, Properly_encrypt_and_sign_identity_tokens_in_transit,and_use_industry_standard_session_key_generation_mechanisms).

mitigations(Reusing_Session_IDs(aka_Session_Replay), _, Always_invalidate_a_session_ID_after_the_user_logout).
mitigations(Reusing_Session_IDs(aka_Session_Replay), _, Setup_a_session_time_out_for_the_session_IDs).
mitigations(Reusing_Session_IDs(aka_Session_Replay), _, Use_SSL_to_mitigate_man_in_the_middle_attack).
mitigations(Reusing_Session_IDs(aka_Session_Replay), _, Do_not_code_send_session_ID_with_GET_method).
mitigations(Reusing_Session_IDs(aka_Session_Replay), _, Encrypt_the_session_data_associated_with_the_session_ID).
mitigations(Reusing_Session_IDs(aka_Session_Replay), _, Use_multifactor_authentication).

mitigations(Session_Fixation, _, Use_a_strict_session_management_mechanism_that_only_accepts_locally_generated_session_identifiers).
mitigations(Session_Fixation, _, Regenerate_and_destroy_session_identifiers_when_there_is_a_change_in_the_level_of_privilege).
mitigations(Session_Fixation, _, Use_session_identifiers_that_are_difficult_to_guess_or_brute-force).

mitigations(Session_Sidejacking, _, Make_sure_that_HTTPS_is_used_to_communicate_with_the_target_system.Alternatively,use_VPN_if_possible).
mitigations(Session_Sidejacking, _, Modify_the_session_token_with_each_transmission_and_protect_it_with_cryptography).

mitigations(Cross_Site_Tracing, _, Administrators_should_disable_support_for_HTTP_TRACE_at_the_destination's_web_server).
mitigations(Cross_Site_Tracing, _, Patch_web_browser_against_known_security_origin_policy_bypass_exploits).


mitigations(Manipulating_Opaque_Client-based_Data_Tokens, _, Protect_encrypted_data_with_a_CRC_of_some_sort).
mitigations(Manipulating_Opaque_Client-based_Data_Tokens, _, Protect_client_side_authentication_tokens_for_confidentiality_(encryption)_and_integrity_(signed_hash)).
mitigations(Manipulating_Opaque_Client-based_Data_Tokens, _, All_session_tokens_use_a_good_source_of_randomness).
mitigations(Manipulating_Opaque_Client-based_Data_Tokens, _, Perform_validation_on_the_server_side_to_make_sure_that_client_side_data_tokens_are_consistent_with_what_is_expected).

mitigations(Accessing/Intercepting/Modifying_HTTP_Cookies, Design, Use_input_validation_for_cookies).
mitigations(Accessing/Intercepting/Modifying_HTTP_Cookies, Design, Generate_and_validate_MAC_for_cookies).
mitigations(Accessing/Intercepting/Modifying_HTTP_Cookies, Implementation, Use_SSL/TLS_to_protect_cookie_in_transit).
mitigations(Accessing/Intercepting/Modifying_HTTP_Cookies, Implementation, Ensure_the_web_server_implements_all_relevant_security_patches,_many_exploitable_buffer_overflows_are_fixed_in_patches_issued_for_the_software).

mitigations(Manipulating_User-Controlled_Variables, _, Do_not_allow_override_of_global_variables_and_do_Not_Trust_Global_Variables).
mitigations(Manipulating_User-Controlled_Variables, _, If_the_register_globals_option_is_enabled,_PHP_will_create_global_variables_for_each_GET,_POST,_and_cookie_variable_included_in_the_HTTP_request).
mitigations(Manipulating_User-Controlled_Variables, _, A_software_system_should_be_reluctant_to_trust_variables_that_have_been_initialized_outside_of_its_trust_boundary).
mitigations(Manipulating_User-Controlled_Variables, _, Separate_the_presentation_layer_and_the_business_logic_layer).
mitigations(Manipulating_User-Controlled_Variables, _, Use_encapsulation_when_declaring_your_variables..
mitigations(Manipulating_User-Controlled_Variables, _, Assume_all_input_is_malicious).

mitigations(Subverting_Environment_Variable_Values, _, Protect_environment_variables_against_unauthorized_read_and_write_access).
mitigations(Subverting_Environment_Variable_Values, _, Protect_the_configuration_files_which_contain_environment_variables_against_illegitimate_read_and_write_access).
mitigations(Subverting_Environment_Variable_Values, _, Assume_all_input_is_malicious).
mitigations(Subverting_Environment_Variable_Values, _, Apply_the_least_privilege_principles).

mitigations(Removing_Important_Client_Functionality, Design, For_any_security_checks_that_are_performed_on_the_client_side,_ensure_that_these_checks_are_duplicated_on_the_server_side).
mitigations(Removing_Important_Client_Functionality, Design, Ship_client-side_application_with_integrity_checks_(code_signing)_when_possible).
mitigations(Removing_Important_Client_Functionality,  Design,Use_obfuscation_and_other_techniques_to_prevent_reverse_engineering_the_client_code ).

mitigations(XML_Routing_Detour_Attacks, Design, Specify_maximum_number_intermediate_nodes_for_the_request_and_require_SSL_connections_with_mutual_authentication).
mitigations(XML_Routing_Detour_Attacks, Implementation, Use_SSL_for_connections_between_all_parties_with_mutual_authentication).


mitigations(Leveraging_Active_Man_in_the_Middle_Attacks_to_Bypass_Same_Origin_Policy, Design, Tunnel_communications_through_a_secure_proxy).
mitigations(Leveraging_Active_Man_in_the_Middle_Attacks_to_Bypass_Same_Origin_Policy, Design, Trust_level_separation_for_privileged_/_non_privileged_interactions).

mitigations(Reflection_Attack_in_Authentication_Protocol, _, The_server_must_initiate_the_handshake_by_issuing_the_challenge).
mitigations(Reflection_Attack_in_Authentication_Protocol, _, The_use_of_HMAC_to_hash_the_response_from_the_server_can_also_be_used_to_thwart_reflection).
mitigations(Reflection_Attack_in_Authentication_Protocol, _, Introducing_a_random_nonce_with_each_new_connection_ensures_that_the_attacker_cannot_employ_two_connections_to_attack_the_authentication_protocol).



mitigations(Forceful_Browsing, Authenticate_request_to_every_resource).
mitigations(Forceful_Browsing, Forceful_browsing_can_also_be_made_difficult).


mitigations(Forceful_Browsing, Design, [Use_a_secure_message_authentication_code_(MAC)_function_such_as_an_HMAC-SHA1]).


mitigations( Escaping_Virtualization,Ensure_virtualization_software_is_current_and
_up-to-date).
mitigations( Escaping_Virtualization,Abide_by_the_least_privilege_principle_to_avoid_assigning_users_more_privileges_than_necessary).

mitigations(Escaping_a_Sandbox_by_Calling_Code_in_Another_Language, Design, [Use_obfuscation_and_other_
techniques_to_prevent_reverse_engineering_the_standard_libraries]).
mitigations(Escaping_a_Sandbox_by_Calling_Code_in_Another_Language, Configuration, [Get_latest_updates_for_the_computer]).
mitigations(Escaping_a_Sandbox_by_Calling_Code_in_Another_Language, Assurance, [Use_static_analysis_tool_to_do_code_review_and_dynamic_tool_to_
do_penetration_test_on_the_standard_library]).


mitigations(Accessing_Functionality_Not_Properly_Constrained_by
_ACLs,In_a_J2EE_setting,_administrators_can_associate_a_role_that_is_impossible_for_the_authenticator_to_grant_users,_such_as_"NoAccess").


mitigations(Restful_Privilege_Elevation,Design, [Enforce_principle_of_least_privilege]).
mitigations(Restful_Privilege_Elevation,Implementation, [Ensure_that_HTTP_Get_methods_only_retrieve_state_and_do_not_alter_state_on_the_server_side]).
mitigations(Restful_Privilege_Elevation,Implementation, [Ensure_that_HTTP_methods_have_proper_ACLs_based_on_what_the_functionality_they_expose]).

mitigations(Using_Malicious_Files,Implementation, [Perform_testing_such_as_pen-testing_and_vulnerability_scanning_to_identify_directories, programs,and_interfaces_that_grant_direct_access_to_executables]).
mitigations(Using_Malicious_Files,Design, [Enforce_principle_of_least_privilege]).
mitigations(Using_Malicious_Files,Design, [Run server_interfaces_with_a_non-root_account_and/or_utili_even_if_attacker_gains_some_limited_access_to_commands]).

mitigations(Modify_Shared_File, Disallow_shared_content).

mitigations(Add_Malicious_File_to_Shared_Webroot, Ensure_proper_permissions_on_directories_that_are_accessible_through_a_web_server).

mitigations(Replace_Binaries, Insure_that_binaries_commonly_used_by_the_system_have_the_correct_file_permissions).

mitigations(Upload_a_Web_Shell_to_a_Web_Server, Make_sure_your_web_server_is_up-to-date_with_all_patches_to_protect_against_known_vulnerabilities).
mitigations(Upload_a_Web_Shell_to_a_Web_Server, Ensure_that_the_file_permissions_in_directories_on_the_web_server_from_which_files_can_be_execute_is_set_to_the_"least privilege"_settings).

mitigations(Exploiting_Incorrectly_Configured_Access_Control_Security_Levels,Design,[ Configure_the_access_control_correctly]).

mitigations( Restful_Privilege_Elevation,Design,[Enforce_principle_of_least_privilege]).
mitigations( Restful_Privilege_Elevation,Impelmentation,Ensure_that_HTTP_Get_methods_only_retrieve_state_and_do_not_alter_state_on_the_server_side]).
mitigations( Restful_Privilege_Elevation,Implementation,[Ensure_that_HTTP_methods_have_proper_ACLs_based_on_what_the_functionality_they_expose]).


mitigations(WebView_Exposure, To_mitigate_this_type_of_an_attack, an_application_should_limit_permissions_to_only_those_required_an-should_verify_the_origin_of_all_web_content_it_loads).

mitigations(Subvert_Code-signing_Facilities,A_given_code_signing_scheme_may_be_fallible_due_to_improper_use_of_cryptography).
mitigations(Subvert_Code-signing_Facilities,Developers_must_never_roll_out_their_own_cryptography,_nor_should_existing_primitives_be_modified_or_ignored).

mitigations(Target_Programs_with_Elevated_Privileges,Apply_the_principle_of_least_privilege).
mitigations(Target_Programs_with_Elevated_Privileges,Validate_all_untrusted_data).
mitigations(Target_Programs_with_Elevated_Privileges,Apply_the_latest_patches).

mitigations(Cross_Zone_Scripting,Disable_script_execution).
mitigations(Cross_Zone_Scripting,Limit_the_flow_of_untrusted_data_into_the_privileged_areas_of_the_system_that_run_in_the_higher_trust_zone).
mitigations(Cross_Zone_Scripting,Ensure_proper_HTML_output_encoding_before_writing_user_supplied_data_to_the_page).
mitigations(Smudge_Attack, _, Strong_physical_security_of_the_device).


mitigations(Remote_Services_with_Stolen_Credentials, _, Disable_RDP,_telnet,_SSH_and_enable_firewall_rules_to_block_such_traffic).
mitigations(Remote_Services_with_Stolen_Credentials, _, Limit_users_and_accounts_that_have_remote_interactive_login_access).
mitigations(Remote_Services_with_Stolen_Credentials, _, Remove_the_Local_Administrators_group_from_the_list_of_groups_allowed_to_login_through_RDP).
mitigations(Remote_Services_with_Stolen_Credentials, _, Limit_remote_user_permissions).
mitigations(Remote_Services_with_Stolen_Credentials, _, Use_remote_desktop_gateways_and_multifactor_authentication_for_remote_logins).

mitigations(Credential_Stuffing, _, Leverage_multi-factor_authentication_for_all_authentication_services_and_prior_to_granting_an_entity_access_to_the_domain_network).
mitigations(Credential_Stuffing, _, Create_a_strong_password_policy_and_ensure_that_your_system_enforces_this_policy).
mitigations(Credential_Stuffing, _, Ensure_users_are_not_reusing_username/password_combinations_for_multiple_systems,_applications,_or_services).
mitigations(Credential_Stuffing, _, Do_not_reuse_local_administrator_account_credentials_across_systems).
mitigations(Credential_Stuffing, _,Deny_remote_use_of_local_admin_credentials_to_log_into_domain_systems).
mitigations(Credential_Stuffing, _, Do_not_allow_accounts_to_be_a_local_administrator_on_more_than_one_system).
mitigations(Credential_Stuffing, _, Implement_an_intelligent_password_throttling_mechanism).
mitigations(Credential_Stuffing, _, 
Monitor_system_and_domain_logs_for_abnormal_credential_access).


mitigations(Use_of_Known_Kerberos_Credentials,_,Create_a_strong_password_policy_and_ensure_that_your_system_enforces_this_policy_for_Kerberos_service_accounts).
mitigations(Use_of_Known_Kerberos_Credentials,_,Ensure_Kerberos_service_accounts_are_not_reusing_username/password_combinations_for_multiple_systems,_applications,_or_services).
mitigations(Use_of_Known_Kerberos_Credentials,_,Do_not_reuse_Kerberos_service_account_credentials_across_systems).
mitigations(Use_of_Known_Kerberos_Credentials,_,Deny_remote_use_of_Kerberos_service_account_credentials_to_log_into_domain_systems).
mitigations(Use_of_Known_Kerberos_Credentials,_,Do_not_allow_Kerberos_service_accounts_to_be_a_local_administrator_on_more_than_one_system).
mitigations(Use_of_Known_Kerberos_Credentials,_,Enable_at_least_AES_Kerberos_encryption_for_tickets).
mitigations(Use_of_Known_Kerberos_Credentials,_,Monitor_system_and_domain_logs_for_abnormal_credential_access).



mitigations(Kerberoasting,_,Employ_a_robust_password_policy_for_service_accounts).
mitigations(Kerberoasting,_,Employ_the_principle_of_least_privilege:_limit_service_accounts_privileges_to_what_is_required_for_functionality_and_no_more).
mitigations(Kerberoasting,_,Enable_AES_Kerberos_encryption).

mitigations(Use_of_Captured_Tickets,_,Reset_the_built-in_KRBTGT_account_password_twice_to_invalidate_the_existence_of_any_current_Golden_Tickets_and_any_tickets_derived_from_them).
mitigations(Use_of_Captured_Tickets,_,Monitor_system_and_domain_logs_for_abnormal_access).

mitigations(Use_of_Known_Windows_Credentials,_,Leverage_multi-factor_authentication_for_all_authentication_services_and_prior_to_granting_an_entity_access_to_the_domain_network).
mitigations(Use_of_Known_Windows_Credentials,_,Create_a_strong_password_policy_and_ensure_that_your_system_enforces_this_policy).
mitigations(Use_of_Known_Windows_Credentials,_,Ensure_users_are_not_reusing_username/password_combinations_for_multiple_systems,_applications,_or_services).
mitigations(Use_of_Known_Windows_Credentials,_,Do_not_reuse_local_administrator_account_credentials_across_systems).
mitigations(Use_of_Known_Windows_Credentials,_,Deny_remote_use_of_local_admin_credentials_to_log_into_domain_systems).
mitigations(Use_of_Known_Windows_Credentials,_,Do_not_allow_accounts_to_be_a_local_administrator_on_more_than_one_system).
mitigations(Use_of_Known_Windows_Credentials,_,Implement_an_intelligent_password_throttling_mechanism).
mitigations(Use_of_Known_Windows_Credentials,_,Monitor_system_and_domain_logs_for_abnormal_credential_access).



mitigations(Windows_Admin_Shares_with_Stolen_Credentials,_,Implement_an_intelligent_password_throttling_mechanism).
mitigations(Windows_Admin_Shares_with_Stolen_Credentials,_,Deny_remote_use_of_local_admin_credentials_to_log_into_domain_systems).
mitigations(Windows_Admin_Shares_with_Stolen_Credentials,_,Do_not_allow_accounts_to_be_a_local_administrator_on_more_than_one_system).

mitigations(Use_of_Captured_Hashes,_,Prevent_the_use_of_Lan_Man_and_NT_Lan_Man_authentication_on_severs_and_apply_patch_KB2871997_to_Windows_7_and_higher_systems).
mitigations(Use_of_Captured_Hashes,_,Leverage_multi-factor_authentication_for_all_authentication_services_and_prior_to_granting_an_entity_access_to_the_domain_network).
mitigations(Use_of_Captured_Hashes,_,Monitor_system_and_domain_logs_for_abnormal_credential_access).
mitigations(Use_of_Captured_Hashes,_,Create_a_strong_password_policy_and_ensure_that_your_system_enforces_this_policy).
mitigations(Use_of_Captured_Hashes,_,Leverage_system_penetration_testing_and_other_defense_in_depth_methods_to_determine_vulnerable_systems_within_a_domain).


mitigations(Use_of_Captured_Hashes,_,Prevent_the_use_of_Lan_Man_and_NT_Lan_Man_authentication_on_severs_and_apply_patch_KB2871997_to_Windows_7_and_higher_systems).
mitigations(Use_of_Captured_Hashes,_,Leverage_multi-factor_authentication_for_all_authentication_services_and_prior_to_granting_an_entity_access_to_the_domain_network).
mitigations(Use_of_Captured_Hashes,_,Monitor_system_and_domain_logs_for_abnormal_credential_access).
mitigations(Use_of_Captured_Hashes,_,Create_a_strong_password_policy_and_ensure_that_your_system_enforces_this_policy).
mitigations(Use_of_Captured_Hashes,_,Leverage_system_penetration_testing_and_other_defense_in_depth_methods_to_determine_vulnerable_systems_within_a_domain).




%PRAVILA

%lista preduslova za uneti napad
prerequisite1(A,L) :- findAll(P,prerequisites(A,P),L).


% lista mera koje treba preduzeti za uneti napad
mitigation1(A,L) :- findAll(P,mitigations(A,_,P),L).

% lista slabosti do kojih moze doci prilikom unetog napada
weaknesses1(A,L) :- findAll(P,weaknesses(A,P,_),L).



